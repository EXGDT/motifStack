checkInteger <- function(N){
    !length(grep("[^[:digit:]]", as.character(N)))
}

#' @importFrom grDevices col2rgb
hex2psrgb<-function(col){
    col<-col2rgb(col)
    col<-col/255
    col<-paste(col,collapse=" ")
    col
}

#' @importFrom grDevices col2rgb rgb
colalpha <- function(col, alpha){
  col<-col2rgb(col)
  rgb(t(col), alpha = round(alpha*255), maxColorValue = 255)
}

#' @importFrom grDevices svg dev.off
#' @importFrom grid convertHeight stringHeight grid.text gpar polygonGrob
#' @importFrom utils install.packages
importSVG <- function(font, color, ch, fontface="bold", envir=.globals){
  if(capabilities("cairo") && !requireNamespace("grImport2", quietly = TRUE)){
    ## install grImport2
    install.packages("grImport2", repos = "https://cloud.r-project.org",
                     quiet = TRUE)
  }
  if(capabilities("cairo") && requireNamespace("grImport2", quietly = TRUE)){
    psfilename<-tempfile(fileext = ".svg")
    svg(psfilename, width = 1, height = 1, bg = NA, pointsize=72, family = font)
    h <- convertHeight(stringHeight(ch), unitTo = "points", valueOnly = TRUE)
    grid.text(ch, gp = gpar(fontsize=floor(1.05*72*(72/h)), 
                            fontfamily=font, col=color, fontface=fontface))
    dev.off()
    x <- grImport2::readPicture(psfilename)
    unlink(psfilename)
    assign("pictureGrob", grImport2::pictureGrob, envir=envir)
    return(x)
  }
  checkGhost <- function(){
    # get ghostscript path
    gscmd <- Sys.getenv("R_GSCMD")
    if(is.null(gscmd) || !nzchar(gscmd)) {
      gscmd <- switch(.Platform$OS.type,
                      unix = "gs",
                      windows = {
                        poss <- Sys.which(c("gswin64c.exe",
                                            "gswin32c.exe"))
                        poss <- poss[nzchar(poss)]
                        if (length(poss)) gscmd <- poss
                      })
    }
    return((!is.null(gscmd)) || nzchar(gscmd))
  }
  if(checkGhost() && !requireNamespace("grImport", quietly = TRUE)){
    ## install grImport
    install.packages("grImport", repos = "https://cloud.r-project.org",
                     quiet = TRUE)
  }
  if(checkGhost() && requireNamespace("grImport", quietly = TRUE)){
    motifStack_private_fontsize <- 18
    ps<-paste("%!PS\n/",font,
              " findfont\n",motifStack_private_fontsize,
              " scalefont\n",
              hex2psrgb(color),
              " setrgbcolor\nsetfont\nnewpath\n0 0 moveto\n(",
              ch,") show",sep="")
    psfilename<-tempfile()
    psfilename <- gsub("\\", "/", psfilename, fixed=TRUE)
    # step1 create a ps file
    cat(ps,file=paste(psfilename,".ps",sep=""))
    # step2 convert it by grImport::PostScriptTrace
    grImport::PostScriptTrace(paste(psfilename,".ps",sep=""), 
                              paste(psfilename,".xml",sep=""))
    # step3 read by grImport::readPicture
    x<-grImport::readPicture(paste(psfilename,".xml",sep=""))
    unlink(c(paste(psfilename,".ps",sep=""), 
             paste("capture",basename(psfilename),".ps",sep=""), 
             paste(psfilename,".xml",sep="")))
    assign("pictureGrob", grImport::pictureGrob, envir=envir)
    return(x)
  }
  warning("No import funciton (grImport or grImport2) available.",
          "Use predefined fonts.")
  assign("pictureGrob", function(picture, x = .5, y = .5,
                                 width = 1, height = 1, 
                                 just = "centre", distort = TRUE){
    ## plot
    gl <- gList()
    for(i in seq_along(picture)){
      gl <- gList(gl, polygonGrob(picture[[i]]$x,
                                  picture[[i]]$y,
                                  gp = gpar(fill=picture[[i]]$color)))
    }
    return(gl)
  }, envir=envir)
  letterPolygon <- 
    list(A=list(list(color="black", 
                     x=c(1,0.7607811,0.6859235,0.3148902,0.2400325,
                         0,0.3604557,0.640358,1),
                     y=c(0,0,0.2446256,0.2446256,0,0,1,1,0)),
                list(color="white",  
                     x=c(0.5004068,0.5000488,0.4996257,0.4991375,0.4985842,
                         0.4979658,0.4972823,0.4965338,0.4957201,0.4948413,
                         0.4938975,0.4938975,0.4930594,0.4921725,0.4912368,
                         0.4902522,0.4892189,0.4881367,0.4870057,0.4858259,
                         0.4845972,0.4833198,0.4833198,0.4820016,0.4806509,
                         0.4792677,0.4778519,0.4764036,0.4749227,0.4734093,
                         0.4718633,0.4702848,0.4686737,0.4686737,0.467201,
                         0.465712,0.4642067,0.4626851,0.4611473,0.4595932,
                         0.4580228,0.4564361,0.4548332,0.453214,0.453214,
                         0.3653377,0.635476,0.5475997,0.5459723,0.544345,
                         0.5427177,0.5410903,0.539463,0.5378356,0.5362083,
                         0.534581,0.5329536,0.5313263,0.5313263,0.5298698,
                         0.5284296,0.5270057,0.525598,0.5242067,0.5228316,
                         0.5214727,0.5201302,0.5188039,0.5174939,0.5174939,
                         0.5162083,0.5149552,0.5137347,0.5125468,0.5113914,
                         0.5102685,0.5091782,0.5081204,0.5070952,0.5061025,
                         0.5061025,0.5053133,0.5045728,0.5038812,0.5032384,
                         0.5026444,0.5020993,0.5016029,0.5011554,0.5007567,
                         0.5004068,0.5004068),
                     y=c(0.8650852,0.8634915,0.8616753,0.8596368,0.8573758,
                         0.8548925,0.8521868,0.8492587,0.8461082,0.8427354,
                         0.8391401,0.8391401,0.8353818,0.8315196,0.8275537,
                         0.8234841,0.8193106,0.8150334,0.8106523,0.8061675,
                         0.8015789,0.7968866,0.7968866,0.7920979,0.7872202,
                         0.7822535,0.7771979,0.7720534,0.7668199,0.7614974,
                         0.756086,0.7505856,0.7449963,0.7449963,0.7395182,
                         0.7340549,0.7286064,0.7231727,0.7177539,0.7123499,
                         0.7069607,0.7015864,0.6962268,0.6908821,0.6908821,
                         0.409192,0.409192,0.6908821,0.6962268,0.7015864,
                         0.7069607,0.7123499,0.7177539,0.7231727,0.7286064,
                         0.7340549,0.7395182,0.7449963,0.7449963,0.7505856,
                         0.756086,0.7614974,0.7668199,0.7720534,0.7771979,
                         0.7822535,0.7872202,0.7920979,0.7968866,0.7968866,
                         0.8015789,0.8061675,0.8106523,0.8150334,0.8193106,
                         0.8234841,0.8275537,0.8315196,0.8353818,0.8391401,
                         0.8391401,0.8427354,0.8461082,0.8492587,0.8521868,
                         0.8548925,0.8573758,0.8596368,0.8616753,0.8634915,
                         0.8650852,0.8650852))
                ),
         B=list(list(color="black", 
                     x=c(1,0.9996378,0.998551,0.9967398,0.994204,0.9909438,
                         0.986959,0.9822498,0.976816,0.9706578,0.963775,
                         0.963775,0.9562822,0.9482936,0.9398093,0.9308294,
                         0.9213537,0.9113823,0.9009152,0.8899523,0.8784938,
                         0.8665396,0.8665396,0.8541373,0.8413346,0.8281316,
                         0.8145281,0.8005243,0.7861201,0.7713155,0.7561106,
                         0.7405052,0.7244995,0.7244995,0.7083889,0.6920877,
                         0.6755958,0.6589133,0.64204,0.6249762,0.6077216,
                         0.5902765,0.5726406,0.5548141,0.5548141,0,0,0.5004766,
                         0.5200953,0.5392946,0.5580744,0.5764347,0.5943756,
                         0.611897,0.628999,0.6456816,0.6619447,0.6777884,
                         0.6777884,0.693184,0.708103,0.7225453,0.736511,0.75,
                         0.7630124,0.7755481,0.7876072,0.7991897,0.8102955,
                         0.8102955,0.8209056,0.831001,0.8405815,0.8496473,
                         0.8581983,0.8662345,0.873756,0.8807626,0.8872545,
                         0.8932316,0.8932316,0.8988465,0.9038704,0.9083031,
                         0.9121449,0.9153956,0.9180553,0.9201239,0.9216015,
                         0.9224881,0.9227836,0.9227836,0.9221544,0.9202669,
                         0.9171211,0.9127169,0.9070543,0.9001335,0.8919542,
                         0.8825167,0.8718208,0.8598665,0.8598665,0.8466063,
                         0.8319924,0.8160248,0.7987035,0.7800286,0.76,0.7386177,
                         0.7158818,0.6917922,0.6663489,0.6663489,0.6981697,
                         0.7284271,0.7571211,0.7842517,0.8098189,0.8338227,
                         0.8562631,0.8771401,0.8964538,0.914204,0.914204,
                         0.9305052,0.9450906,0.95796,0.9691134,0.978551,
                         0.9862726,0.9922784,0.9965682,0.999142,1,1),
                     y=c(0.2853966,0.2703484,0.255745,0.2415864,0.2278725,
                         0.2146034,0.2017791,0.1893996,0.1774648,0.1659748,
                         0.1549296,0.1549296,0.1442995,0.1340549,0.1241957,
                         0.114722,0.1056338,0.09693106,0.08861379,0.08068199,
                         0.07313566,0.0659748,0.0659748,0.05933284,0.0530467,
                         0.04711638,0.04154188,0.0363232,0.03146034,0.0269533,
                         0.02280208,0.01900667,0.01556709,0.01556709,0.01260934,
                         0.009962936,0.007627872,0.005604151,0.003891772,
                         0.002490734,0.001401038,0.0006226835,0.0001556709,0,0,
                         0,1,1,0.9998443,0.9993773,0.998599,0.9975093,0.9961082,
                         0.9943958,0.9923721,0.9900371,0.9873907,0.9844329,
                         0.9844329,0.9813047,0.9778503,0.9740697,0.9699629,
                         0.96553,0.9607709,0.9556857,0.9502743,0.9445367,
                         0.9384729,0.9384729,0.932083,0.9253669,0.9183247,
                         0.9109563,0.9032617,0.8952409,0.886894,0.8782209,
                         0.8692216,0.8598962,0.8598962,0.8502446,0.8402669,
                         0.8299629,0.8193328,0.8083766,0.7970941,0.7854855,
                         0.7735508,0.7612898,0.7487027,0.7487027,0.7319199,
                         0.7156709,0.6999555,0.6847739,0.670126,0.6560119,
                         0.6424314,0.6293847,0.6168718,0.6048925,0.6048925,
                         0.5936916,0.5832172,0.5734692,0.5644477,0.5561527,
                         0.5485841,0.541742,0.5356264,0.5302372,0.5255745,
                         0.5255745,0.5224166,0.5182802,0.5131653,0.5070719,0.5,
                         0.4919496,0.4829207,0.4729133,0.4619274,0.4499629,
                         0.4499629,0.437109,0.4234544,0.4089993,0.3937435,
                         0.3776872,0.3608302,0.3431727,0.3247146,0.3054559,
                         0.2853966,0.2853966)),
                list(color="white",  
                     x=c(0.6396568,0.6392278,0.6379409,0.635796,0.6327931,0.6289323,0.6242135,0.6186368,0.6122021,0.6049094,0.5967588,0.5967588,0.5878742,0.5783794,0.5682745,0.5575596,0.5462345,0.5342993,0.5217541,0.5085987,0.4948332,0.4804576,0.4804576,0.2812202,0.2812202,0.4823642,0.4974357,0.5117636,0.525348,0.5381888,0.550286,0.5616397,0.5722498,0.5821163,0.5912393,0.5996187,0.5996187,0.6072259,0.6140324,0.6200381,0.6252431,0.6296473,0.6332507,0.6360534,0.6380553,0.6392564,0.6396568,0.6396568,NA,0.7168732,0.7167112,0.716225,0.7154147,0.7142803,0.7128217,0.7110391,0.7089323,0.7065014,0.7037464,0.7006673,0.7006673,0.6973117,0.6937274,0.6899142,0.6858723,0.6816015,0.677102,0.6723737,0.6674166,0.6622307,0.656816,0.656816,0.6513823,0.6457579,0.6399428,0.6339371,0.6277407,0.6213537,0.614776,0.6080076,0.6010486,0.593899,0.593899,0.5868065,0.5796378,0.5723928,0.5650715,0.557674,0.5502002,0.5426501,0.5350238,0.5273213,0.5195424,0.5195424,0.2812202,0.2812202,0.5262154,0.5338036,0.5413155,0.5487512,0.5561106,0.5633937,0.5706006,0.5777312,0.5847855,0.5917636,0.5986654,0.5986654,0.6056244,0.6123928,0.6189704,0.6253575,0.6315539,0.6375596,0.6433746,0.648999,0.6544328,0.6596759,0.6596759,0.6648999,0.6698951,0.6746616,0.6791992,0.6835081,0.6875882,0.6914395,0.695062,0.6984557,0.7016206,0.7016206,0.7045186,0.7071115,0.7093994,0.7113823,0.7130601,0.7144328,0.7155005,0.7162631,0.7167207,0.7168732,0.7168732),
                     y=c(0.7190511,0.7315715,0.7433358,0.754344,0.764596,0.7740919,0.7828317,0.7908154,0.798043,0.8045145,0.8102298,0.8102298,0.8154411,0.8201038,0.8242179,0.8277835,0.8308006,0.8332691,0.835189,0.8365604,0.8373832,0.8376575,0.8376575,0.8376575,0.6011861,0.6011861,0.6014826,0.6023721,0.6038547,0.6059303,0.608599,0.6118606,0.6157153,0.6201631,0.6252039,0.6308377,0.6308377,0.6370571,0.6438547,0.6512305,0.6591846,0.6677168,0.6768273,0.6865159,0.6967828,0.7076279,0.7190511,0.7190511,NA,0.3039288,0.3115122,0.3188436,0.3259229,0.3327502,0.3393254,0.3456486,0.3517198,0.3575389,0.363106,0.3684211,0.3684211,0.3735063,0.378384,0.3830541,0.3875167,0.3917717,0.3958191,0.399659,0.4032913,0.4067161,0.4099333,0.4099333,0.4130986,0.4160712,0.418851,0.4214381,0.4238325,0.4260341,0.428043,0.4298592,0.4314826,0.4329133,0.4329133,0.4341809,0.435315,0.4363158,0.4371831,0.437917,0.4385174,0.4389844,0.439318,0.4395182,0.4395849,0.4395849,0.4395849,0.1623425,0.1623425,0.1624092,0.1626093,0.1629429,0.1634099,0.1640104,0.1647443,0.1656116,0.1666123,0.1677465,0.1690141,0.1690141,0.1704374,0.1720385,0.1738176,0.1757746,0.1779096,0.1802224,0.1827131,0.1853818,0.1882283,0.1912528,0.1912528,0.1946256,0.1982209,0.2020385,0.2060786,0.210341,0.2148258,0.219533,0.2244626,0.2296145,0.2349889,0.2349889,0.2406153,0.2465234,0.2527131,0.2591846,0.2659377,0.2729726,0.2802891,0.2878873,0.2957672,0.3039288,0.3039288)),
                list(color="white",  
                     x=c(0.7168732,0.7167112,0.716225,0.7154147,0.7142803,0.7128217,0.7110391,0.7089323,0.7065014,0.7037464,0.7006673,0.7006673,0.6973117,0.6937274,0.6899142,0.6858723,0.6816015,0.677102,0.6723737,0.6674166,0.6622307,0.656816,0.656816,0.6513823,0.6457579,0.6399428,0.6339371,0.6277407,0.6213537,0.614776,0.6080076,0.6010486,0.593899,0.593899,0.5868065,0.5796378,0.5723928,0.5650715,0.557674,0.5502002,0.5426501,0.5350238,0.5273213,0.5195424,0.5195424,0.2812202,0.2812202,0.5262154,0.5338036,0.5413155,0.5487512,0.5561106,0.5633937,0.5706006,0.5777312,0.5847855,0.5917636,0.5986654,0.5986654,0.6056244,0.6123928,0.6189704,0.6253575,0.6315539,0.6375596,0.6433746,0.648999,0.6544328,0.6596759,0.6596759,0.6648999,0.6698951,0.6746616,0.6791992,0.6835081,0.6875882,0.6914395,0.695062,0.6984557,0.7016206,0.7016206,0.7045186,0.7071115,0.7093994,0.7113823,0.7130601,0.7144328,0.7155005,0.7162631,0.7167207,0.7168732,0.7168732),
                     y=c(0.3039288,0.3115122,0.3188436,0.3259229,0.3327502,0.3393254,0.3456486,0.3517198,0.3575389,0.363106,0.3684211,0.3684211,0.3735063,0.378384,0.3830541,0.3875167,0.3917717,0.3958191,0.399659,0.4032913,0.4067161,0.4099333,0.4099333,0.4130986,0.4160712,0.418851,0.4214381,0.4238325,0.4260341,0.428043,0.4298592,0.4314826,0.4329133,0.4329133,0.4341809,0.435315,0.4363158,0.4371831,0.437917,0.4385174,0.4389844,0.439318,0.4395182,0.4395849,0.4395849,0.4395849,0.1623425,0.1623425,0.1624092,0.1626093,0.1629429,0.1634099,0.1640104,0.1647443,0.1656116,0.1666123,0.1677465,0.1690141,0.1690141,0.1704374,0.1720385,0.1738176,0.1757746,0.1779096,0.1802224,0.1827131,0.1853818,0.1882283,0.1912528,0.1912528,0.1946256,0.1982209,0.2020385,0.2060786,0.210341,0.2148258,0.219533,0.2244626,0.2296145,0.2349889,0.2349889,0.2406153,0.2465234,0.2527131,0.2591846,0.2659377,0.2729726,0.2802891,0.2878873,0.2957672,0.3039288,0.3039288))
                ),
         C=list(list(color="black", 
                     x=c(0.2747253,0.2753663,0.2772894,0.2804945,0.2849817,0.2907509,0.2978022,0.3061355,0.3157509,0.3266484,0.3388278,0.3388278,0.3522802,0.3669963,0.3829762,0.4002198,0.4187271,0.4384982,0.459533,0.4818315,0.5053938,0.5302198,0.5302198,0.5383883,0.5464103,0.5542857,0.5620147,0.5695971,0.577033,0.5843223,0.5914652,0.5984615,0.6053114,0.6053114,0.6120147,0.6185714,0.6249817,0.6312454,0.6373626,0.6433333,0.6491575,0.6548352,0.6603663,0.6657509,0.6657509,0.6711722,0.6764469,0.6815751,0.6865568,0.6913919,0.6960806,0.7006227,0.7050183,0.7092674,0.71337,0.71337,0.7175275,0.7215751,0.7255128,0.7293407,0.7330586,0.7366667,0.7401648,0.7435531,0.7468315,0.75,0.75,1,0.9941758,0.9880586,0.9816484,0.9749451,0.9679487,0.9606593,0.9530769,0.9452015,0.937033,0.9285714,0.9285714,0.9199817,0.9110623,0.9018132,0.8922344,0.882326,0.8720879,0.8615201,0.8506227,0.8393956,0.8278388,0.8278388,0.8161264,0.8040659,0.7916575,0.7789011,0.7657967,0.7523443,0.738544,0.7243956,0.7098993,0.6950549,0.6950549,0.6800275,0.6646154,0.6488187,0.6326374,0.6160714,0.5991209,0.5817857,0.5640659,0.5459615,0.5274725,0.5274725,0.5000275,0.47337,0.4475,0.4224176,0.3981227,0.3746154,0.3518956,0.3299634,0.3088187,0.2884615,0.2884615,0.2688553,0.2499634,0.2317857,0.2143223,0.1975733,0.1815385,0.1662179,0.1516117,0.1377198,0.1245421,0.1245421,0.1120604,0.1002564,0.08913004,0.07868132,0.06891026,0.05981685,0.0514011,0.043663,0.03660256,0.03021978,0.03021978,0.02447802,0.01934066,0.01480769,0.01087912,0.007554945,0.004835165,0.00271978,0.001208791,0.0003021978,0,0,0.0003113553,0.001245421,0.002802198,0.004981685,0.007783883,0.01120879,0.01525641,0.01992674,0.02521978,0.03113553,0.03113553,0.03769231,0.04490842,0.05278388,0.06131868,0.07051282,0.0803663,0.09087912,0.1020513,0.1138828,0.1263736,0.1263736,0.139707,0.1536996,0.1683516,0.183663,0.1996337,0.2162637,0.2335531,0.2515018,0.2701099,0.2893773,0.2893773,0.3093223,0.3299634,0.3513004,0.3733333,0.3960623,0.4194872,0.4436081,0.4684249,0.4939377,0.5201465,0.5201465,0.5389744,0.5573626,0.5753114,0.5928205,0.6098901,0.6265201,0.6427106,0.6584615,0.6737729,0.6886447,0.6886447,0.7032875,0.7175458,0.7314194,0.7449084,0.7580128,0.7707326,0.7830678,0.7950183,0.8065842,0.8177656,0.8177656,0.8287637,0.8394139,0.8497161,0.8596703,0.8692766,0.8785348,0.8874451,0.8960073,0.9042216,0.9120879,0.9120879,0.9196337,0.9268864,0.9338462,0.9405128,0.9468864,0.952967,0.9587546,0.9642491,0.9694505,0.974359,0.974359,0.7252747,0.7228205,0.7202198,0.7174725,0.7145788,0.7115385,0.7083516,0.7050183,0.7015385,0.6979121,0.6941392,0.6941392,0.6904029,0.6865201,0.6824908,0.678315,0.6739927,0.6695238,0.6649084,0.6601465,0.6552381,0.6501832,0.6501832,0.6449908,0.6396703,0.6342216,0.6286447,0.6229396,0.6171062,0.6111447,0.6050549,0.598837,0.5924908,0.5924908,0.5861996,0.5797802,0.5732326,0.5665568,0.5597527,0.5528205,0.5457601,0.5385714,0.5312546,0.5238095,0.5238095,0.4995238,0.4764835,0.4546886,0.4341392,0.4148352,0.3967766,0.3799634,0.3643956,0.3500733,0.3369963,0.3369963,0.3251648,0.3145788,0.3052381,0.2971429,0.290293,0.2846886,0.2803297,0.2772161,0.275348,0.2747253,0.2747253),
                     y=c(0.5043165,0.4726835,0.4425324,0.4138633,0.3866763,0.3609712,0.3367482,0.3140072,0.2927482,0.2729712,0.2546763,0.2546763,0.238,0.2230791,0.2099137,0.1985036,0.1888489,0.1809496,0.1748058,0.1704173,0.1677842,0.1669065,0.1669065,0.167036,0.1674245,0.1680719,0.1689784,0.1701439,0.1715683,0.1732518,0.1751942,0.1773957,0.1798561,0.1798561,0.1825468,0.1854388,0.1885324,0.1918273,0.1953237,0.1990216,0.2029209,0.2070216,0.2113237,0.2158273,0.2158273,0.2206619,0.2256691,0.2308489,0.2362014,0.2417266,0.2474245,0.253295,0.2593381,0.265554,0.2719424,0.2719424,0.2784748,0.2851223,0.2918849,0.2987626,0.3057554,0.3128633,0.3200863,0.3274245,0.3348777,0.342446,0.342446,0.305036,0.2909353,0.2771223,0.2635971,0.2503597,0.2374101,0.2247482,0.2123741,0.2002878,0.1884892,0.1769784,0.1769784,0.1659209,0.1551942,0.1447986,0.1347338,0.125,0.1155971,0.1065252,0.09778417,0.0893741,0.08129496,0.08129496,0.07369784,0.06644604,0.05953957,0.05297842,0.04676259,0.04089209,0.03536691,0.03018705,0.02535252,0.02086331,0.02086331,0.01689928,0.01335252,0.01022302,0.007510791,0.005215827,0.003338129,0.001877698,0.0008345324,0.0002086331,0,0,0.0003597122,0.001438849,0.00323741,0.005755396,0.008992806,0.01294964,0.0176259,0.02302158,0.02913669,0.03597122,0.03597122,0.04360432,0.05182734,0.06064029,0.07004317,0.08003597,0.09061871,0.1017914,0.113554,0.1259065,0.1388489,0.1388489,0.1523525,0.1663885,0.1809568,0.1960576,0.2116906,0.2278561,0.244554,0.2617842,0.2795468,0.2978417,0.2978417,0.3166115,0.3357986,0.3554029,0.3754245,0.3958633,0.4167194,0.4379928,0.4596835,0.4817914,0.5043165,0.5043165,0.5280647,0.5512518,0.5738777,0.5959424,0.617446,0.6383885,0.6587698,0.6785899,0.6978489,0.7165468,0.7165468,0.7346763,0.7522302,0.7692086,0.7856115,0.8014388,0.8166906,0.8313669,0.8454676,0.8589928,0.8719424,0.8719424,0.884295,0.8960288,0.9071439,0.9176403,0.927518,0.936777,0.9454173,0.9534388,0.9608417,0.9676259,0.9676259,0.973777,0.9792806,0.9841367,0.9883453,0.9919065,0.9948201,0.9970863,0.998705,0.9996763,1,1,0.9997914,0.9991655,0.9981223,0.9966619,0.9947842,0.9924892,0.989777,0.9866475,0.9831007,0.9791367,0.9791367,0.9747986,0.9701295,0.9651295,0.9597986,0.9541367,0.9481439,0.9418201,0.9351655,0.9281799,0.9208633,0.9208633,0.9133741,0.9055827,0.8974892,0.8890935,0.8803957,0.8713957,0.8620935,0.8524892,0.8425827,0.8323741,0.8323741,0.8220576,0.8115396,0.8008201,0.7898993,0.778777,0.7674532,0.7559281,0.7442014,0.7322734,0.7201439,0.7201439,0.6726619,0.679518,0.6862734,0.6929281,0.699482,0.7059353,0.7122878,0.7185396,0.7246906,0.730741,0.7366906,0.7366906,0.7425108,0.7481727,0.7536763,0.7590216,0.7642086,0.7692374,0.7741079,0.7788201,0.7833741,0.7877698,0.7877698,0.7919856,0.796,0.7998129,0.8034245,0.8068345,0.8100432,0.8130504,0.8158561,0.8184604,0.8208633,0.8208633,0.8231871,0.8252662,0.8271007,0.8286906,0.830036,0.8311367,0.8319928,0.8326043,0.8329712,0.8330935,0.8330935,0.832259,0.8297554,0.8255827,0.819741,0.8122302,0.8030504,0.7922014,0.7796835,0.7654964,0.7496403,0.7496403,0.732295,0.7133525,0.6928129,0.6706763,0.6469424,0.6216115,0.5946835,0.5661583,0.536036,0.5043165,0.5043165))
                ),
         D=list(list(color="black", 
                     x=c(1,0.9996055,0.9984221,0.9964497,0.9936884,0.9901381,0.9857988,0.9806706,0.9747535,0.9680473,0.9605523,0.9605523,0.9523077,0.9433531,0.9336884,0.9233136,0.9122288,0.9004339,0.887929,0.874714,0.860789,0.8461538,0.8461538,0.8308185,0.8147929,0.7980769,0.7806706,0.762574,0.743787,0.7243097,0.704142,0.683284,0.6617357,0.6617357,0.6397436,0.6171598,0.5939842,0.570217,0.545858,0.5209073,0.4953649,0.4692308,0.4425049,0.4151874,0.4151874,0,0,0.3560158,0.3868245,0.4169231,0.4463116,0.4749901,0.5029586,0.530217,0.5567653,0.5826036,0.6077318,0.6321499,0.6321499,0.6558284,0.6787377,0.7008777,0.7222485,0.7428501,0.7626824,0.7817456,0.8000394,0.8175641,0.8343195,0.8343195,0.850286,0.8654438,0.8797929,0.8933333,0.9060651,0.9179882,0.9291026,0.9394083,0.9489053,0.9575937,0.9575937,0.9656509,0.97286,0.9792209,0.9847337,0.9893984,0.993215,0.9961834,0.9983037,0.9995759,1,1),
                     y=c(0.5077835,0.4831727,0.4591549,0.4357302,0.4128984,0.3906597,0.3690141,0.3479615,0.3275019,0.3076353,0.2883617,0.2883617,0.2696887,0.2516234,0.234166,0.2173165,0.2010749,0.1854411,0.1704151,0.155997,0.1421868,0.1289844,0.1289844,0.1165456,0.1047294,0.09353595,0.08296516,0.07301705,0.06369162,0.05498888,0.04690882,0.03945145,0.03261675,0.03261675,0.02641957,0.02087472,0.01598221,0.01174203,0.008154188,0.005218681,0.002935508,0.00130467,0.0003261675,0,0,0,1,1,0.9997109,0.9988436,0.9973981,0.9953744,0.9927724,0.9895923,0.985834,0.9814974,0.9765827,0.9710897,0.9710897,0.9649963,0.9582802,0.9509414,0.94298,0.9343958,0.925189,0.9153595,0.9049073,0.8938325,0.8821349,0.8821349,0.8697924,0.8567828,0.843106,0.828762,0.8137509,0.7980726,0.7817272,0.7647146,0.7470348,0.7286879,0.7286879,0.7097999,0.6902001,0.6698888,0.6488658,0.6271312,0.604685,0.5815271,0.5576575,0.5330764,0.5077835,0.5077835)),
                list(color="white",  
                     x=c(0.7071006,0.7068836,0.7062327,0.7051479,0.7036292,0.7016765,0.6992899,0.6964694,0.693215,0.6895266,0.6854043,0.6854043,0.6808383,0.6758185,0.6703452,0.6644181,0.6580375,0.6512032,0.6439152,0.6361736,0.6279783,0.6193294,0.6193294,0.6104142,0.6010256,0.5911637,0.5808284,0.5700197,0.5587377,0.5469822,0.5347535,0.5220513,0.5088757,0.5088757,0.4952268,0.4811045,0.4665089,0.4514398,0.4358974,0.4198817,0.4033925,0.38643,0.3689941,0.3510848,0.3510848,0.290927,0.290927,0.3915187,0.4226529,0.4521499,0.4800099,0.5062327,0.5308185,0.5537673,0.5750789,0.5947535,0.6127909,0.6291913,0.6291913,0.6439941,0.6572387,0.668925,0.6790533,0.6876233,0.6946351,0.7000888,0.7039842,0.7063215,0.7071006,0.7071006),
                     y=c(0.5077835,0.5248703,0.5414381,0.557487,0.573017,0.5880282,0.6025204,0.6164937,0.6299481,0.6428836,0.6553002,0.6553002,0.6673758,0.6789918,0.6901483,0.7008451,0.7110823,0.7208599,0.7301779,0.7390363,0.7474351,0.7553744,0.7553744,0.763017,0.7702298,0.7770126,0.7833655,0.7892884,0.7947813,0.7998443,0.8044774,0.8086805,0.8124537,0.8124537,0.8159748,0.8191253,0.8219051,0.8243143,0.8263529,0.8280208,0.829318,0.8302446,0.8308006,0.8309859,0.8309859,0.8309859,0.1690141,0.1690141,0.1698592,0.1723944,0.1766197,0.1825352,0.1901408,0.1994366,0.2104225,0.2230986,0.2374648,0.2535211,0.2535211,0.2714085,0.2909711,0.312209,0.3351223,0.3597109,0.3859748,0.413914,0.4435285,0.4748184,0.5077835,0.5077835))
                ),
         E=list(list(color="black", 
                     x=c(0,0,0.9593657,0.9593657,0.2923687,0.2923687,0.8989098,0.8989098,0.2923687,0.2923687,1,1,0),
                     y=c(0,1,1,0.8309859,0.8309859,0.590808,0.590808,0.4217939,0.4217939,0.1690141,0.1690141,0,0))
                ),
         F=list(list(color="black", 
                     x=c(0.314164,0.314164,0.9755059,0.9755059,0.314164,0.314164,0,0,1,1,0.314164),
                     y=c(0.8309859,0.5463306,0.5463306,0.3773165,0.3773165,0,0,1,1,0.8309859,0.8309859))
                ),
         G=list(list(color="black", 
                     x=c(1,0.992624,0.985,0.9771279,0.9690076,0.9606393,0.9520229,0.9431584,0.9340458,0.9246851,0.9150763,0.9150763,0.9054103,0.8954962,0.885334,0.8749237,0.8642653,0.8533588,0.8422042,0.8308015,0.8191508,0.8072519,0.8072519,0.7953149,0.7831679,0.7708111,0.7582443,0.7454676,0.7324809,0.7192844,0.7058779,0.6922615,0.6784351,0.6784351,0.6644084,0.6501908,0.6357824,0.6211832,0.6063931,0.5914122,0.5762405,0.5608779,0.5453244,0.5295802,0.5295802,0.5030153,0.4771374,0.4519466,0.4274427,0.403626,0.3804962,0.3580534,0.3362977,0.315229,0.2948473,0.2948473,0.275334,0.2564885,0.2383111,0.2208015,0.2039599,0.1877863,0.1722805,0.1574427,0.1432729,0.129771,0.129771,0.116937,0.104771,0.0932729,0.08244275,0.07228053,0.06278626,0.05395992,0.04580153,0.03831107,0.03148855,0.03148855,0.02550573,0.02015267,0.01542939,0.01133588,0.007872137,0.005038168,0.002833969,0.001259542,0.0003148855,0,0,0.0003148855,0.001259542,0.002833969,0.005038168,0.007872137,0.01133588,0.01542939,0.02015267,0.02550573,0.03148855,0.03148855,0.03812023,0.04541985,0.0533874,0.0620229,0.07132634,0.08129771,0.09193702,0.1032443,0.1152195,0.1278626,0.1278626,0.141374,0.1555725,0.170458,0.1860305,0.2022901,0.2192366,0.2368702,0.2551908,0.2741985,0.2938931,0.2938931,0.314313,0.3354962,0.3574427,0.3801527,0.403626,0.4278626,0.4528626,0.478626,0.5051527,0.5324427,0.5324427,0.5512882,0.5696565,0.5875477,0.6049618,0.6218989,0.6383588,0.6543416,0.6698473,0.684876,0.6994275,0.6994275,0.7137309,0.7276336,0.7411355,0.7542366,0.766937,0.7792366,0.7911355,0.8026336,0.8137309,0.8244275,0.8244275,0.8349427,0.8451145,0.8549427,0.8644275,0.8735687,0.8823664,0.8908206,0.8989313,0.9066985,0.9141221,0.9141221,0.9212405,0.9280916,0.9346756,0.9409924,0.947042,0.9528244,0.9583397,0.9635878,0.9685687,0.9732824,0.9732824,0.7118321,0.7064885,0.7007634,0.6946565,0.6881679,0.6812977,0.6740458,0.6664122,0.6583969,0.65,0.6412214,0.6412214,0.6320897,0.6226336,0.6128531,0.6027481,0.5923187,0.5815649,0.5704866,0.559084,0.5473569,0.5353053,0.5353053,0.5217748,0.5086641,0.4959733,0.4837023,0.4718511,0.4604198,0.4494084,0.4388168,0.428645,0.4188931,0.4188931,0.4095324,0.4005344,0.3918989,0.383626,0.3757156,0.3681679,0.3609828,0.3541603,0.3477004,0.3416031,0.3416031,0.3358492,0.3304198,0.3253149,0.3205344,0.3160782,0.3119466,0.3081393,0.3046565,0.3014981,0.2986641,0.2986641,0.296126,0.293855,0.2918511,0.2901145,0.288645,0.2874427,0.2865076,0.2858397,0.2854389,0.2853053,0.2853053,0.2859447,0.2878626,0.2910592,0.2955344,0.3012882,0.3083206,0.3166317,0.3262214,0.3370897,0.3492366,0.3492366,0.3626908,0.3774809,0.3936069,0.4110687,0.4298664,0.45,0.4714695,0.4942748,0.518416,0.5438931,0.5438931,0.5510973,0.5582061,0.5652195,0.5721374,0.5789599,0.585687,0.5923187,0.598855,0.6052958,0.6116412,0.6116412,0.6180534,0.624313,0.6304198,0.636374,0.6421756,0.6478244,0.6533206,0.6586641,0.663855,0.6688931,0.6688931,0.6739695,0.6788931,0.6836641,0.6882824,0.6927481,0.6970611,0.7012214,0.705229,0.709084,0.7127863,0.7127863,0.7165172,0.7200763,0.7234637,0.7266794,0.7297233,0.7325954,0.7352958,0.7378244,0.7401813,0.7423664,0.7423664,0.7423664,0.480916,0.480916,1,1),
                     y=c(0.147482,0.1428489,0.1381583,0.1334101,0.1286043,0.123741,0.1188201,0.1138417,0.1088058,0.1037122,0.09856115,0.09856115,0.09341727,0.08834532,0.08334532,0.07841727,0.07356115,0.06877698,0.06406475,0.05942446,0.05485612,0.05035971,0.05035971,0.04611511,0.04201439,0.03805755,0.0342446,0.03057554,0.02705036,0.02366906,0.02043165,0.01733813,0.01438849,0.01438849,0.01165468,0.009208633,0.00705036,0.005179856,0.003597122,0.002302158,0.001294964,0.0005755396,0.0001438849,0,0,0.0003741007,0.001496403,0.003366906,0.005985612,0.009352518,0.01346763,0.01833094,0.02394245,0.03030216,0.03741007,0.03741007,0.04532374,0.05381295,0.0628777,0.07251799,0.08273381,0.09352518,0.1048921,0.1168345,0.1293525,0.142446,0.142446,0.1560791,0.1702158,0.1848561,0.2,0.2156475,0.2317986,0.2484532,0.2656115,0.2832734,0.3014388,0.3014388,0.3201727,0.3392518,0.3586763,0.378446,0.3985612,0.4190216,0.4398273,0.4609784,0.4824748,0.5043165,0.5043165,0.5280647,0.5512518,0.5738777,0.5959424,0.617446,0.6383885,0.6587698,0.6785899,0.6978489,0.7165468,0.7165468,0.7348058,0.7524604,0.7695108,0.7859568,0.8017986,0.817036,0.8316691,0.8456978,0.8591223,0.8719424,0.8719424,0.884295,0.8960288,0.9071439,0.9176403,0.927518,0.936777,0.9454173,0.9534388,0.9608417,0.9676259,0.9676259,0.973777,0.9792806,0.9841367,0.9883453,0.9919065,0.9948201,0.9970863,0.998705,0.9996763,1,1,0.9998058,0.999223,0.9982518,0.9968921,0.9951439,0.9930072,0.990482,0.9875683,0.9842662,0.9805755,0.9805755,0.9765252,0.9721439,0.9674317,0.9623885,0.9570144,0.9513094,0.9452734,0.9389065,0.9322086,0.9251799,0.9251799,0.9179856,0.9105036,0.9027338,0.8946763,0.8863309,0.8776978,0.868777,0.8595683,0.8500719,0.8402878,0.8402878,0.8302518,0.82,0.8095324,0.7988489,0.7879496,0.7768345,0.7655036,0.7539568,0.7421942,0.7302158,0.7302158,0.6913669,0.7053813,0.7186475,0.7311655,0.7429353,0.7539568,0.7642302,0.7737554,0.7825324,0.7905612,0.7978417,0.7978417,0.8045396,0.8105324,0.8158201,0.8204029,0.8242806,0.8274532,0.8299209,0.8316835,0.832741,0.8330935,0.8330935,0.8328777,0.8322302,0.8311511,0.8296403,0.8276978,0.8253237,0.822518,0.8192806,0.8156115,0.8115108,0.8115108,0.8071295,0.8023309,0.7971151,0.791482,0.7854317,0.778964,0.7720791,0.764777,0.7570576,0.7489209,0.7489209,0.7405108,0.7316835,0.7224388,0.712777,0.7026978,0.6922014,0.6812878,0.6699568,0.6582086,0.6460432,0.6460432,0.6336187,0.6208058,0.6076043,0.5940144,0.580036,0.5656691,0.5509137,0.5357698,0.5202374,0.5043165,0.5043165,0.472964,0.4430791,0.4146619,0.3877122,0.3622302,0.3382158,0.3156691,0.2945899,0.2749784,0.2568345,0.2568345,0.240295,0.2254964,0.2124388,0.2011223,0.1915468,0.1837122,0.1776187,0.1732662,0.1706547,0.1697842,0.1697842,0.1698417,0.1700144,0.1703022,0.170705,0.171223,0.1718561,0.1726043,0.1734676,0.174446,0.1755396,0.1755396,0.1768489,0.1781871,0.179554,0.1809496,0.1823741,0.1838273,0.1853094,0.1868201,0.1883597,0.1899281,0.1899281,0.1916547,0.1933813,0.1951079,0.1968345,0.1985612,0.2002878,0.2020144,0.203741,0.2054676,0.2071942,0.2071942,0.209036,0.2108201,0.2125468,0.2142158,0.2158273,0.2173813,0.2188777,0.2203165,0.2216978,0.2230216,0.2230216,0.3920863,0.3920863,0.5489209,0.5489209,0.147482))
                ),
         H=list(list(color="black", 
                     x=c(0.6904512,0.6904512,0.3095488,0.3095488,0,0,0.3095488,0.3095488,0.6904512,0.6904512,1,1,0.6904512),
                     y=c(0,0.4255004,0.4255004,0,0,1,1,0.6063751,0.6063751,1,1,0,0))
                ),
         I=list(list(color="black", 
                     x=c(0.1276423,0.8723577,0.8723577,0.6195122,0.6195122,0.8723577,0.8723577,0.1276423,0.1276423,0.3804878,0.3804878,0.1276423,0.1276423),
                     y=c(1,1,0.8309859,0.8309859,0.1690141,0.1690141,0,0,0.1690141,0.1690141,0.8309859,0.8309859,1))
                ),
         J=list(list(color="black", 
                     x=c(0.5038168,0.4824427,0.4615049,0.4410033,0.4209378,0.4013086,0.3821156,0.3633588,0.3450382,0.3271538,0.3097056,0.3097056,0.2927045,0.2761614,0.2600763,0.2444493,0.2292803,0.2145692,0.2003162,0.1865213,0.1731843,0.1603053,0.1603053,0.1478844,0.1359215,0.1244166,0.1133697,0.1027808,0.09264995,0.0829771,0.07376227,0.06500545,0.05670665,0.05670665,0.04887677,0.04152672,0.03465649,0.02826609,0.02235551,0.01692475,0.01197383,0.007502726,0.00351145,0,0,0.3173391,0.3219738,0.3271538,0.332879,0.3391494,0.3459651,0.3533261,0.3612323,0.3696838,0.3786805,0.3882225,0.3882225,0.3982334,0.4086369,0.4194329,0.4306216,0.4422028,0.4541767,0.4665431,0.4793021,0.4924537,0.5059978,0.5059978,0.5215921,0.5365322,0.5508179,0.5644493,0.5774264,0.5897492,0.6014177,0.6124318,0.6227917,0.6324973,0.6324973,0.6414068,0.6493784,0.6564122,0.6625082,0.6676663,0.6718866,0.675169,0.6775136,0.6789204,0.6793893,0.6793893,0.6793893,0.351145,0.351145,1,1,0.9996619,0.9986478,0.9969575,0.9945911,0.9915485,0.9878299,0.9834351,0.9783642,0.9726172,0.9661941,0.9661941,0.9593348,0.951843,0.9437186,0.9349618,0.9255725,0.9155507,0.9048964,0.8936096,0.8816903,0.8691385,0.8691385,0.8561941,0.8426609,0.8285387,0.8138277,0.7985278,0.782639,0.7661614,0.7490949,0.7314395,0.7131952,0.7131952,0.6946129,0.6755071,0.6558779,0.6357252,0.6150491,0.5938495,0.5721265,0.54988,0.5271101,0.5038168,0.5038168),
                     y=c(0,0.0002045289,0.0008181154,0.00184076,0.003272462,0.005113221,0.007363039,0.01002191,0.01308985,0.01656684,0.02045289,0.02045289,0.02473338,0.02939372,0.03443389,0.03985391,0.04565376,0.05183346,0.05839299,0.06533236,0.07265157,0.08035062,0.08035062,0.0884149,0.0968298,0.1055953,0.1147115,0.1241782,0.1339956,0.1441636,0.1546822,0.1655515,0.1767714,0.1767714,0.1884733,0.2004967,0.2128415,0.2255077,0.2384953,0.2518042,0.2654346,0.2793864,0.2936596,0.3082542,0.3082542,0.339664,0.3228634,0.3069394,0.2918919,0.277721,0.2644266,0.2520088,0.2404675,0.2298028,0.2200146,0.211103,0.211103,0.2030533,0.195851,0.189496,0.1839883,0.179328,0.175515,0.1725493,0.170431,0.16916,0.1687363,0.1687363,0.1691673,0.1704602,0.172615,0.1756318,0.1795106,0.1842513,0.1898539,0.1963185,0.203645,0.2118335,0.2118335,0.2208254,0.2305625,0.2410446,0.2522717,0.264244,0.2769613,0.2904237,0.3046311,0.3195836,0.3352812,0.3352812,0.8312637,0.8312637,1,1,0.3403944,0.3249087,0.3097151,0.2948137,0.2802045,0.2658875,0.2518627,0.23813,0.2246896,0.2115413,0.1986852,0.1986852,0.1863039,0.1742878,0.162637,0.1513514,0.140431,0.1298758,0.1196859,0.1098612,0.1004018,0.09130752,0.09130752,0.08273923,0.07456538,0.06678598,0.05940102,0.05241052,0.04581446,0.03961286,0.0338057,0.02839299,0.02337473,0.02337473,0.01893353,0.01495982,0.01145362,0.008414901,0.005843682,0.003739956,0.002103725,0.000934989,0.0002337473,0,0))
                ),
         K=list(list(color="black", 
                     x=c(0.6816102,0.3860933,0.2698994,0.2698994,0,0,0.2698994,0.2698994,0.6688015,0.9826167,0.5617566,1,0.6816102),
                     y=c(0,0.4128984,0.3076353,0,0,1,1,0.5559674,1,1,0.5707932,0,0))
                ),
         L=list(list(color="black", 
                     x=c(0,0,0.32382,0.32382,1,1,0),
                     y=c(0,1,1,0.1690141,0.1690141,0,0))
                ),
         M=list(list(color="black", 
                     x=c(0.7846751,0.7846751,0.7846945,0.7847527,0.7848497,0.7849855,0.78516,0.7853734,0.7856256,0.7859166,0.7862464,0.7866149,0.7866149,0.7871969,0.7877789,0.7883608,0.7889428,0.7895247,0.7901067,0.7906887,0.7912706,0.7918526,0.7924345,0.7924345,0.7932105,0.7939864,0.7947624,0.7955383,0.7963143,0.7970902,0.7978661,0.7986421,0.799418,0.800194,0.800194,0.7974879,0.7948012,0.7921339,0.7894859,0.7868574,0.7842483,0.7816586,0.7790883,0.7765373,0.7740058,0.7740058,0.7728419,0.771678,0.7705141,0.7693501,0.7681862,0.7670223,0.7658584,0.7646945,0.7635306,0.7623666,0.7623666,0.7612027,0.7600388,0.7588749,0.757711,0.756547,0.7553831,0.7542192,0.7530553,0.7518914,0.7507274,0.7507274,0.7495635,0.7483996,0.7472357,0.7460718,0.7449079,0.7437439,0.74258,0.7414161,0.7402522,0.7390883,0.7390883,0.7379243,0.7367604,0.7355965,0.7344326,0.7332687,0.7321048,0.7309408,0.7297769,0.728613,0.7274491,0.7274491,0.6071775,0.3957323,0.2735209,0.2727255,0.2718914,0.2710184,0.2701067,0.2691562,0.2681668,0.2671387,0.2660718,0.2649661,0.2638215,0.2638215,0.2626576,0.2614937,0.2603298,0.2591659,0.2580019,0.256838,0.2556741,0.2545102,0.2533463,0.2521823,0.2521823,0.2510087,0.2498157,0.2486033,0.2473715,0.2461203,0.2448497,0.2435597,0.2422502,0.2409214,0.2395732,0.2395732,0.2384093,0.2372454,0.2360815,0.2349176,0.2337536,0.2325897,0.2314258,0.2302619,0.229098,0.227934,0.227934,0.2252085,0.2224636,0.2196993,0.2169156,0.2141125,0.21129,0.2084481,0.2055868,0.2027061,0.199806,0.199806,0.2003977,0.2010087,0.2016392,0.202289,0.2029583,0.2036469,0.204355,0.2050824,0.2058293,0.2065955,0.2065955,0.2071678,0.2077207,0.2082541,0.2087682,0.2092629,0.2097381,0.210194,0.2106305,0.2110475,0.2114452,0.2114452,0.2118138,0.2121435,0.2124345,0.2126867,0.2129001,0.2130747,0.2132105,0.2133075,0.2133657,0.2133851,0.2133851,0.2133851,0,0,0.3365664,0.4675073,0.4690398,0.4705335,0.4719884,0.4734045,0.4747818,0.4761203,0.47742,0.4786809,0.479903,0.4810863,0.4810863,0.4824248,0.4837245,0.4849855,0.4862076,0.4873909,0.4885354,0.4896411,0.4907081,0.4917362,0.4927255,0.4927255,0.4938894,0.4950533,0.4962173,0.4973812,0.4985451,0.499709,0.5008729,0.5020369,0.5032008,0.5043647,0.5043647,0.5055383,0.5067313,0.5079437,0.5091756,0.5104268,0.5116974,0.5129874,0.5142968,0.5156256,0.5169738,0.5169738,0.5181474,0.5193404,0.5205529,0.5217847,0.5230359,0.5243065,0.5255965,0.5269059,0.5282347,0.5295829,0.5295829,0.5309408,0.5322987,0.5336566,0.5350145,0.5363725,0.5377304,0.5390883,0.5404462,0.5418041,0.543162,0.543162,0.6750727,1,1,0.7846751),
                     y=c(0,0.6434396,0.6510156,0.6586212,0.6662565,0.6739214,0.681616,0.6893403,0.6970941,0.7048777,0.7126909,0.7205337,0.7205337,0.7283247,0.7359822,0.7435063,0.750897,0.7581542,0.765278,0.7722683,0.7791253,0.7858488,0.7924388,0.7924388,0.7999852,0.8075019,0.8149889,0.8224463,0.829874,0.8372721,0.8446405,0.8519792,0.8592884,0.8665678,0.8665678,0.8563751,0.8462565,0.836212,0.8262417,0.8163454,0.8065234,0.7967754,0.7871016,0.7775019,0.7679763,0.7679763,0.7639585,0.759911,0.755834,0.7517272,0.7475908,0.7434248,0.7392291,0.7350037,0.7307487,0.726464,0.726464,0.722172,0.7178947,0.7136323,0.7093847,0.705152,0.700934,0.6967309,0.6925426,0.6883692,0.6842105,0.6842105,0.6802224,0.6762639,0.6723351,0.6684359,0.6645663,0.6607265,0.6569162,0.6531357,0.6493847,0.6456635,0.6456635,0.6421423,0.6386953,0.6353225,0.6320237,0.6287991,0.6256486,0.6225723,0.6195701,0.616642,0.613788,0.613788,0.2668643,0.2668643,0.613788,0.6160712,0.6184729,0.6209933,0.6236323,0.6263899,0.6292661,0.6322609,0.6353744,0.6386064,0.641957,0.641957,0.6453966,0.6488955,0.6524537,0.6560712,0.659748,0.6634841,0.6672795,0.6711342,0.6750482,0.6790215,0.6790215,0.6830393,0.6870867,0.6911638,0.6952706,0.699407,0.703573,0.7077687,0.7119941,0.7162491,0.7205337,0.7205337,0.7248258,0.729103,0.7333655,0.737613,0.7418458,0.7460638,0.7502669,0.7544552,0.7586286,0.7627872,0.7627872,0.7726316,0.7825945,0.7926761,0.8028762,0.813195,0.8236323,0.8341883,0.8448629,0.855656,0.8665678,0.8665678,0.8594218,0.8522165,0.8449518,0.8376279,0.8302446,0.8228021,0.8153002,0.8077391,0.8001186,0.7924388,0.7924388,0.7857079,0.7788584,0.7718903,0.7648036,0.7575982,0.7502743,0.7428317,0.7352706,0.7275908,0.7197924,0.7197924,0.7120904,0.7044033,0.6967309,0.6890734,0.6814307,0.6738028,0.6661898,0.6585915,0.6510082,0.6434396,0.6434396,0,0,1,1,0.6300964,0.6261453,0.6220015,0.6176649,0.6131357,0.6084136,0.6034989,0.5983914,0.5930912,0.5875982,0.5819125,0.5819125,0.5761453,0.5704077,0.5646998,0.5590215,0.5533729,0.5477539,0.5421646,0.5366049,0.5310749,0.5255745,0.5255745,0.5191698,0.5127057,0.5061824,0.4995997,0.4929577,0.4862565,0.4794959,0.4726761,0.4657969,0.4588584,0.4588584,0.4657969,0.4726761,0.4794959,0.4862565,0.4929577,0.4995997,0.5061824,0.5127057,0.5191698,0.5255745,0.5255745,0.5310675,0.5365752,0.5420979,0.5476353,0.5531875,0.5587546,0.5643365,0.5699333,0.5755448,0.5811712,0.5811712,0.5868569,0.5923499,0.5976501,0.6027576,0.6076723,0.6123944,0.6169236,0.6212602,0.625404,0.6293551,0.6293551,1,1,0,0))
                ),
         N=list(list(color="black", 
                     x=c(0.6392075,0.2387904,0.240438,0.2420438,0.2436079,0.2451303,0.2466111,0.2480501,0.2494473,0.2508029,0.2521168,0.2533889,0.2533889,0.2540042,0.2545985,0.2551721,0.2557247,0.2562565,0.2567675,0.2572576,0.2577268,0.2581752,0.2586027,0.2586027,0.2592179,0.2598123,0.2603858,0.2609385,0.2614703,0.2619812,0.2624713,0.2629406,0.2633889,0.2638165,0.2638165,0.2642231,0.264609,0.2649739,0.265318,0.2656413,0.2659437,0.2662252,0.2664859,0.2667258,0.2669447,0.2669447,0.2671429,0.2673201,0.2674765,0.2676121,0.2677268,0.2678206,0.2678936,0.2679458,0.2679771,0.2679875,0.2679875,0.2679875,0,0,0.3514077,0.7612096,0.759562,0.7579562,0.7563921,0.7548697,0.7533889,0.7519499,0.7505527,0.7491971,0.7478832,0.7466111,0.7466111,0.7455683,0.7445255,0.7434828,0.74244,0.7413973,0.7403545,0.7393118,0.738269,0.7372263,0.7361835,0.7361835,0.735391,0.734682,0.7340563,0.7335141,0.7330553,0.7326799,0.7323879,0.7321794,0.7320542,0.7320125,0.7320125,0.7320125,1,1,0.6392075),
                     y=c(0,0.7487027,0.7380726,0.7275315,0.7170793,0.7067161,0.6964418,0.6862565,0.6761601,0.6661527,0.6562342,0.6464047,0.6464047,0.6422387,0.638043,0.6338176,0.6295626,0.625278,0.6209637,0.6166197,0.6122461,0.6078428,0.6034099,0.6034099,0.5989696,0.5945441,0.5901334,0.5857376,0.5813566,0.5769904,0.572639,0.5683024,0.5639807,0.5596738,0.5596738,0.5555374,0.5514307,0.5473536,0.5433062,0.5392884,0.5353002,0.5313417,0.5274129,0.5235137,0.5196442,0.5196442,0.5159748,0.5123795,0.5088584,0.5054114,0.5020385,0.4987398,0.4955152,0.4923647,0.4892884,0.4862861,0.4862861,0,0,1,1,0.2312824,0.2412083,0.2511193,0.2610156,0.270897,0.2807635,0.2906153,0.3004522,0.3102743,0.3200815,0.329874,0.329874,0.3383617,0.3469236,0.3555597,0.3642698,0.3730541,0.3819125,0.3908451,0.3998517,0.4089325,0.4180875,0.4180875,0.4273314,0.4363825,0.4452409,0.4539066,0.4623795,0.4706597,0.4787472,0.486642,0.494344,0.5018532,0.5018532,1,1,0,0))
                ),
         O=list(list(color="black", 
                     x=c(1,0.9987097,0.9948387,0.9883871,0.9793548,0.9677419,0.9535484,0.9367742,0.9174194,0.8954839,0.8709677,0.8709677,0.8440369,0.8148571,0.7834286,0.7497512,0.7138249,0.6756498,0.6352258,0.592553,0.5476313,0.5004608,0.5004608,0.4532811,0.4083318,0.3656129,0.3251244,0.2868664,0.2508387,0.2170415,0.1854747,0.1561382,0.1290323,0.1290323,0.1045161,0.08258065,0.06322581,0.04645161,0.03225806,0.02064516,0.0116129,0.00516129,0.001290323,0,0,0.001290323,0.00516129,0.0116129,0.02064516,0.03225806,0.04645161,0.06322581,0.08258065,0.1045161,0.1290323,0.1290323,0.1561382,0.1854747,0.2170415,0.2508387,0.2868664,0.3251244,0.3656129,0.4083318,0.4532811,0.5004608,0.5004608,0.5476313,0.592553,0.6352258,0.6756498,0.7138249,0.7497512,0.7834286,0.8148571,0.8440369,0.8709677,0.8709677,0.8954839,0.9174194,0.9367742,0.9535484,0.9677419,0.9793548,0.9883871,0.9948387,0.9987097,1,1),
                     y=c(0.5028777,0.454446,0.4084317,0.3648345,0.3236547,0.2848921,0.2485468,0.2146187,0.1831079,0.1540144,0.1273381,0.1273381,0.1031439,0.0814964,0.06239568,0.04584173,0.03183453,0.0203741,0.01146043,0.005093525,0.001273381,0,0,0.001273381,0.005093525,0.01146043,0.0203741,0.03183453,0.04584173,0.06239568,0.0814964,0.1031439,0.1273381,0.1273381,0.1540144,0.1831079,0.2146187,0.2485468,0.2848921,0.3236547,0.3648345,0.4084317,0.454446,0.5028777,0.5028777,0.5512806,0.5972086,0.6406619,0.6816403,0.7201439,0.7561727,0.7897266,0.8208058,0.8494101,0.8755396,0.8755396,0.8991871,0.9203453,0.9390144,0.9551942,0.9688849,0.9800863,0.9887986,0.9950216,0.9987554,1,1,0.9987554,0.9950216,0.9887986,0.9800863,0.9688849,0.9551942,0.9390144,0.9203453,0.8991871,0.8755396,0.8755396,0.8494101,0.8208058,0.7897266,0.7561727,0.7201439,0.6816403,0.6406619,0.5972086,0.5512806,0.5028777,0.5028777)),
                list(color="white",  
                     x=c(0.724424,0.7238618,0.7221751,0.7193641,0.7154286,0.7103687,0.7041843,0.6968756,0.6884424,0.6788848,0.6682028,0.6682028,0.6564055,0.6435023,0.6294931,0.6143779,0.5981567,0.5808295,0.5623963,0.5428571,0.522212,0.5004608,0.5004608,0.4787005,0.4580276,0.4384424,0.4199447,0.4025346,0.386212,0.370977,0.3568295,0.3437696,0.3317972,0.3317972,0.3211152,0.3115576,0.3031244,0.2958157,0.2896313,0.2845714,0.2806359,0.2778249,0.2761382,0.275576,0.275576,0.2761382,0.2778249,0.2806359,0.2845714,0.2896313,0.2958157,0.3031244,0.3115576,0.3211152,0.3317972,0.3317972,0.3437696,0.3568295,0.370977,0.386212,0.4025346,0.4199447,0.4384424,0.4580276,0.4787005,0.5004608,0.5004608,0.522212,0.5428571,0.5623963,0.5808295,0.5981567,0.6143779,0.6294931,0.6435023,0.6564055,0.6682028,0.6682028,0.6788848,0.6884424,0.6968756,0.7041843,0.7103687,0.7154286,0.7193641,0.7221751,0.7238618,0.724424,0.724424),
                     y=c(0.5028777,0.5355396,0.5664748,0.5956835,0.6231655,0.6489209,0.6729496,0.6952518,0.7158273,0.7346763,0.7517986,0.7517986,0.7672446,0.7810647,0.793259,0.8038273,0.8127698,0.8200863,0.825777,0.8298417,0.8322806,0.8330935,0.8330935,0.8322662,0.8297842,0.8256475,0.8198561,0.8124101,0.8033094,0.792554,0.7801439,0.7660791,0.7503597,0.7503597,0.7331223,0.7142158,0.6936403,0.6713957,0.647482,0.6218993,0.5946475,0.5657266,0.5351367,0.5028777,0.5028777,0.4705827,0.4398849,0.4107842,0.3832806,0.3573741,0.3330647,0.3103525,0.2892374,0.2697194,0.2517986,0.2517986,0.2356691,0.2212374,0.2085036,0.1974676,0.1881295,0.1804892,0.1745468,0.1703022,0.1677554,0.1669065,0.1669065,0.1677554,0.1703022,0.1745468,0.1804892,0.1881295,0.1974676,0.2085036,0.2212374,0.2356691,0.2517986,0.2517986,0.2697194,0.2892374,0.3103525,0.3330647,0.3573741,0.3832806,0.4107842,0.4398849,0.4705827,0.5028777,0.5028777))
                ),
         P=list(list(color="black", 
                     x=c(1,0.9996918,0.9987674,0.9972266,0.9950696,0.9922962,0.9889066,0.9849006,0.9802783,0.9750398,0.9691849,0.9691849,0.9628926,0.9559443,0.94834,0.9400795,0.931163,0.9215905,0.9113618,0.9004771,0.8889364,0.8767396,0.8767396,0.8638767,0.850338,0.8361233,0.8212326,0.805666,0.7894235,0.772505,0.7549105,0.7366402,0.7176938,0.7176938,0.6980517,0.6776938,0.6566203,0.634831,0.612326,0.5891054,0.565169,0.5405169,0.5151491,0.4890656,0.4890656,0.2932406,0.2932406,0,0,0.4771372,0.5036183,0.5293837,0.5544334,0.5787674,0.6023857,0.6252883,0.6474751,0.6689463,0.6897018,0.7097416,0.7097416,0.7290855,0.7477535,0.7657455,0.7830616,0.7997018,0.815666,0.8309543,0.8455666,0.859503,0.8727634,0.8727634,0.8853479,0.8972565,0.9084891,0.9190457,0.9289264,0.9381312,0.94666,0.9545129,0.9616899,0.9681909,0.9681909,0.9742346,0.9796421,0.9844135,0.9885487,0.9920477,0.9949105,0.9971372,0.9987276,0.9996819,1,1),
                     y=c(0.6842105,0.6707858,0.6574944,0.6443365,0.6313121,0.6184211,0.6056635,0.5930393,0.5805486,0.5681913,0.5559674,0.5559674,0.5441067,0.5325426,0.521275,0.5103039,0.4996294,0.4892513,0.4791698,0.4693847,0.4598962,0.4507042,0.4507042,0.4418458,0.433358,0.4252409,0.4174944,0.4101186,0.4031134,0.3964789,0.390215,0.3843217,0.3787991,0.3787991,0.3738695,0.3694589,0.3655671,0.3621942,0.3593403,0.3570052,0.355189,0.3538918,0.3531134,0.352854,0.352854,0.352854,0,0,1,1,0.9997776,0.9991105,0.9979985,0.9964418,0.9944403,0.9919941,0.989103,0.9857672,0.9819867,0.9777613,0.9777613,0.9732691,0.9683914,0.9631282,0.9574796,0.9514455,0.9450259,0.9382209,0.9310304,0.9234544,0.915493,0.915493,0.9071609,0.8984729,0.8894292,0.8800297,0.8702743,0.8601631,0.8496961,0.8388732,0.8276946,0.8161601,0.8161601,0.8042995,0.7921423,0.7796887,0.7669385,0.7538918,0.7405486,0.7269088,0.7129726,0.6987398,0.6842105,0.6842105)),
                list(color="white",  
                     x=c(0.7047714,0.7041153,0.7021471,0.6988668,0.6942744,0.6883698,0.6811531,0.6726243,0.6627833,0.6516302,0.639165,0.639165,0.6255865,0.6106958,0.594493,0.5769781,0.5581511,0.5380119,0.5165606,0.4937972,0.4697217,0.444334,0.444334,0.2932406,0.2932406,0.4522863,0.4778231,0.5019483,0.524662,0.5459642,0.5658549,0.584334,0.6014016,0.6170577,0.6313022,0.6441352,0.6441352,0.6556561,0.6659642,0.6750596,0.6829423,0.6896123,0.6950696,0.6993141,0.7023459,0.704165,0.7047714,0.7047714),
                     y=c(0.6805041,0.6961972,0.7109563,0.7247813,0.7376723,0.7496294,0.7606523,0.7707413,0.7798962,0.7881171,0.795404,0.795404,0.8020237,0.8079466,0.8131727,0.817702,0.8215345,0.8246701,0.827109,0.828851,0.8298962,0.8302446,0.8302446,0.8302446,0.5211268,0.5211268,0.5215271,0.5227279,0.5247294,0.5275315,0.5311342,0.5355374,0.5407413,0.5467457,0.5535508,0.5611564,0.5611564,0.5696887,0.578977,0.5890215,0.5998221,0.6113788,0.6236916,0.6367606,0.6505856,0.6651668,0.6805041,0.6805041))
                ),
         Q=list(list(color="black", 
                     x=c(0.9899635,0.9890785,0.9864234,0.9819982,0.9758029,0.9678376,0.9581022,0.9465967,0.9333212,0.9182755,0.9014599,0.9014599,0.8831296,0.8631752,0.8415967,0.8183942,0.7935675,0.7671168,0.739042,0.7093431,0.6780201,0.645073,0.645073,0.6487865,0.6526277,0.6565967,0.6606934,0.6649179,0.6692701,0.67375,0.6783577,0.6830931,0.6879562,0.6879562,0.692938,0.6980292,0.7032299,0.7085401,0.7139599,0.7194891,0.7251277,0.7308759,0.7367336,0.7427007,0.7427007,0.7489599,0.7553285,0.7618066,0.7683942,0.7750912,0.7818978,0.7888139,0.7958394,0.8029745,0.810219,0.810219,0.8175639,0.825,0.8325274,0.840146,0.8478558,0.8556569,0.8635493,0.8715328,0.8796077,0.8877737,0.8877737,0.8930931,0.8984672,0.903896,0.9093796,0.9149179,0.9205109,0.9261588,0.9318613,0.9376186,0.9434307,0.9434307,0.9492518,0.9550365,0.9607847,0.9664964,0.9721715,0.9778102,0.9834124,0.9889781,0.9945073,1,1,1,0.9901004,0.9801095,0.9700274,0.959854,0.9495894,0.9392336,0.9287865,0.9182482,0.9076186,0.8968978,0.8968978,0.886031,0.8749635,0.8636953,0.8522263,0.8405566,0.8286861,0.816615,0.8043431,0.7918704,0.7791971,0.7791971,0.7620712,0.745365,0.7290785,0.7132117,0.6977646,0.6827372,0.6681296,0.6539416,0.6401734,0.6268248,0.6268248,0.6140328,0.6015693,0.5894343,0.5776277,0.5661496,0.555,0.5441788,0.5336861,0.5235219,0.5136861,0.5136861,0.5043339,0.4952555,0.4864507,0.4779197,0.4696624,0.4616788,0.453969,0.4465328,0.4393704,0.4324818,0.4324818,0.4258212,0.4193431,0.4130474,0.4069343,0.4010036,0.3952555,0.3896898,0.3843066,0.3791058,0.3740876,0.3740876,0.338458,0.304562,0.2723996,0.2419708,0.2132755,0.1863139,0.1610858,0.1375912,0.1158303,0.09580292,0.09580292,0.07760036,0.06131387,0.04694343,0.03448905,0.02395073,0.01532847,0.008622263,0.003832117,0.0009580292,0,0,0.001277372,0.005109489,0.01149635,0.02043796,0.03193431,0.0459854,0.06259124,0.08175182,0.1034672,0.1277372,0.1277372,0.1545712,0.1836131,0.2148631,0.2483212,0.2839872,0.3218613,0.3619434,0.4042336,0.4487318,0.495438,0.495438,0.542135,0.5866058,0.6288504,0.6688686,0.7066606,0.7422263,0.7755657,0.8066788,0.8355657,0.8622263,0.8622263,0.8864964,0.9082117,0.9273723,0.9439781,0.9580292,0.9695255,0.9784672,0.984854,0.9886861,0.9899635,0.9899635),
                     y=c(0.6102651,0.5784433,0.5479526,0.518793,0.4909645,0.464467,0.4393006,0.4154653,0.3929611,0.3717879,0.3519459,0.3519459,0.3334405,0.3162775,0.3004569,0.2859786,0.2728426,0.2610491,0.2505979,0.241489,0.2337225,0.2272984,0.2272984,0.2212014,0.2153187,0.2096503,0.2041963,0.1989566,0.1939312,0.1891201,0.1845234,0.180141,0.1759729,0.1759729,0.1719966,0.1681895,0.1645516,0.1610829,0.1577834,0.1546531,0.151692,0.1489002,0.1462775,0.143824,0.143824,0.1415285,0.1393796,0.1373773,0.1355217,0.1338127,0.1322504,0.1308347,0.1295657,0.1284433,0.1274676,0.1274676,0.1265031,0.1256402,0.1248787,0.1242188,0.1236605,0.1232036,0.1228483,0.1225945,0.1224422,0.1223914,0.1223914,0.122414,0.1224817,0.1225945,0.1227524,0.1229554,0.1232036,0.1234969,0.1238353,0.1242188,0.1246475,0.1246475,0.1251043,0.1255725,0.1260519,0.1265426,0.1270446,0.1275578,0.1280823,0.1286182,0.1291653,0.1297236,0.1297236,0.01579244,0.01446136,0.01317541,0.01193457,0.01073886,0.009588268,0.008482798,0.007422448,0.006407219,0.005437112,0.004512126,0.004512126,0.003654822,0.002887761,0.002210942,0.001624365,0.001128032,0.0007219402,0.0004060914,0.0001804851,4.512126e-05,0,0,0.0001635646,0.0006542583,0.001472081,0.002617033,0.004089114,0.005888325,0.008014664,0.01046813,0.01324873,0.01635646,0.01635646,0.01976311,0.0234405,0.02738861,0.03160745,0.03609701,0.0408573,0.04588832,0.05119007,0.05676255,0.06260575,0.06260575,0.06858996,0.07481105,0.08126904,0.0879639,0.09489566,0.1020643,0.1094698,0.1171122,0.1249915,0.1331077,0.1331077,0.1414213,0.1498928,0.1585223,0.1673096,0.1762549,0.1853582,0.1946193,0.2040384,0.2136153,0.2233503,0.2233503,0.2288212,0.2357586,0.2441624,0.2540327,0.2653694,0.2781726,0.2924422,0.3081782,0.3253807,0.3440496,0.3440496,0.3641737,0.3857417,0.4087535,0.4332092,0.4591089,0.4864523,0.5152397,0.545471,0.5771461,0.6102651,0.6102651,0.6482121,0.6842188,0.7182854,0.7504117,0.7805979,0.8088438,0.8351495,0.8595149,0.8819402,0.9024253,0.9024253,0.9209645,0.9375522,0.9521884,0.9648731,0.9756063,0.984388,0.9912183,0.996097,0.9990243,1,1,0.9990243,0.996097,0.9912183,0.984388,0.9756063,0.9648731,0.9521884,0.9375522,0.9209645,0.9024253,0.9024253,0.8819402,0.8595149,0.8351495,0.8088438,0.7805979,0.7504117,0.7182854,0.6842188,0.6482121,0.6102651,0.6102651)),
                list(color="white",  
                     x=c(0.7171533,0.7165967,0.714927,0.7121442,0.7082482,0.7032391,0.6971168,0.6898814,0.6815328,0.6720712,0.6614964,0.6614964,0.6498175,0.6370438,0.6231752,0.6082117,0.5921533,0.575,0.5567518,0.5374088,0.5169708,0.495438,0.495438,0.473896,0.4534307,0.434042,0.4157299,0.3984945,0.3823358,0.3672536,0.3532482,0.3403193,0.3284672,0.3284672,0.3178923,0.3084307,0.3000821,0.2928467,0.2867245,0.2817153,0.2778193,0.2750365,0.2733668,0.2728102,0.2728102,0.2733668,0.2750365,0.2778193,0.2817153,0.2867245,0.2928467,0.3000821,0.3084307,0.3178923,0.3284672,0.3284672,0.3403193,0.3532482,0.3672536,0.3823358,0.3984945,0.4157299,0.434042,0.4534307,0.473896,0.495438,0.495438,0.5169708,0.5374088,0.5567518,0.575,0.5921533,0.6082117,0.6231752,0.6370438,0.6498175,0.6614964,0.6614964,0.6720712,0.6815328,0.6898814,0.6971168,0.7032391,0.7082482,0.7121442,0.714927,0.7165967,0.7171533,0.7171533),
                     y=c(0.6102651,0.6358714,0.6601241,0.6830231,0.7045685,0.7247603,0.7435984,0.7610829,0.7772138,0.791991,0.8054146,0.8054146,0.817524,0.8283587,0.8379188,0.8462042,0.8532149,0.8589509,0.8634123,0.866599,0.868511,0.8691483,0.8691483,0.8684997,0.8665539,0.8633108,0.8587704,0.8529329,0.8457981,0.837366,0.8276368,0.8166103,0.8042865,0.8042865,0.7907727,0.7759504,0.7598195,0.7423801,0.7236323,0.7035759,0.6822109,0.6595375,0.6355556,0.6102651,0.6102651,0.5849464,0.5608799,0.5380654,0.5165031,0.4961929,0.4771348,0.4593288,0.442775,0.4274732,0.4134236,0.4134236,0.4007783,0.3894642,0.3794811,0.3708291,0.3635082,0.3575183,0.3528596,0.3495319,0.3475353,0.3468697,0.3468697,0.3475353,0.3495319,0.3528596,0.3575183,0.3635082,0.3708291,0.3794811,0.3894642,0.4007783,0.4134236,0.4134236,0.4274732,0.442775,0.4593288,0.4771348,0.4961929,0.5165031,0.5380654,0.5608799,0.5849464,0.6102651,0.6102651))
                ),
         R=list(list(color="black", 
                     x=c(0.6954128,0.4293578,0.2706422,0.2706422,0,0,0.453211,0.5004312,0.545211,0.5875505,0.6274495,0.6649083,0.6999266,0.7325046,0.7626422,0.7903394,0.8155963,0.8155963,0.8384312,0.8588624,0.8768899,0.8925138,0.9057339,0.9165505,0.9249633,0.9309725,0.934578,0.9357798,0.9357798,0.9355872,0.9350092,0.9340459,0.9326972,0.9309633,0.928844,0.9263394,0.9234495,0.9201743,0.9165138,0.9165138,0.9125138,0.9082202,0.903633,0.8987523,0.893578,0.8881101,0.8823486,0.8762936,0.869945,0.8633028,0.8633028,0.8563853,0.849211,0.8417798,0.8340917,0.8261468,0.817945,0.8094862,0.8007706,0.7917982,0.7825688,0.7825688,0.7731193,0.7634862,0.7536697,0.7436697,0.7334862,0.7231193,0.7125688,0.7018349,0.6909174,0.6798165,0.6798165,1,0.6954128),
                     y=c(0,0.3817643,0.3817643,0,0,1,1,0.9992365,0.9969459,0.9931282,0.9877835,0.9809118,0.972513,0.9625871,0.9511342,0.9381542,0.9236471,0.9236471,0.907702,0.8904077,0.8717643,0.8517717,0.8304299,0.8077391,0.783699,0.7583099,0.7315715,0.7034841,0.7034841,0.6926168,0.681957,0.6715048,0.6612602,0.6512231,0.6413936,0.6317717,0.6223573,0.6131505,0.6041512,0.6041512,0.5953595,0.5867754,0.5783988,0.5702298,0.5622683,0.5545145,0.5469681,0.5396294,0.5324981,0.5255745,0.5255745,0.5189918,0.5125871,0.5063603,0.5003113,0.4944403,0.4887472,0.483232,0.4778947,0.4727354,0.4677539,0.4677539,0.4631134,0.4586805,0.4544552,0.4504374,0.4466271,0.4430245,0.4396294,0.4364418,0.4334618,0.4306894,0.4306894,0,0)),
                list(color="white",  
                     x=c(0.6633028,0.6631376,0.6626422,0.6618165,0.6606606,0.6591743,0.6573578,0.655211,0.6527339,0.6499266,0.646789,0.646789,0.6435229,0.6399633,0.6361101,0.6319633,0.6275229,0.622789,0.6177615,0.6124404,0.6068257,0.6009174,0.6009174,0.5947156,0.5882202,0.5814312,0.5743486,0.5669725,0.5593028,0.5513394,0.5430826,0.5345321,0.5256881,0.5256881,0.5167523,0.5075596,0.4981101,0.4884037,0.4784404,0.4682202,0.4577431,0.4470092,0.4360183,0.4247706,0.4247706,0.2706422,0.2706422,0.4321101,0.4556697,0.4779083,0.4988257,0.518422,0.5366972,0.5536514,0.5692844,0.5835963,0.5965872,0.6082569,0.6082569,0.6187156,0.6280734,0.6363303,0.6434862,0.6495413,0.6544954,0.6583486,0.6611009,0.6627523,0.6633028,0.6633028),
                     y=c(0.6945886,0.7020311,0.7092365,0.7162046,0.7229355,0.7294292,0.7356857,0.741705,0.747487,0.7530319,0.7583395,0.7583395,0.7634248,0.7683024,0.7729726,0.7774351,0.7816901,0.7857376,0.7895775,0.7932098,0.7966345,0.7998517,0.7998517,0.803017,0.8059896,0.8087695,0.8113566,0.8137509,0.8159526,0.8179615,0.8197776,0.821401,0.8228317,0.8228317,0.8242402,0.8255004,0.8266123,0.827576,0.8283914,0.8290586,0.8295775,0.8299481,0.8301705,0.8302446,0.8302446,0.8302446,0.5515196,0.5515196,0.5518829,0.5529726,0.5547887,0.5573314,0.5606004,0.564596,0.569318,0.5747665,0.5809414,0.5878428,0.5878428,0.5955819,0.6039733,0.613017,0.6227131,0.6330615,0.6440623,0.6557153,0.6680208,0.6809785,0.6945886,0.6945886))
                ),
         S=list(list(color="black", 
                     x=c(1,0.9987933,0.995173,0.9891393,0.9806921,0.9698314,0.9565217,0.9407276,0.922449,0.9016859,0.8784383,0.8527063,0.8244898,0.7937888,0.7606034,0.7249335,0.6867436,0.6459982,0.6026974,0.5568412,0.5084295,0.42811,0.3539663,0.2859982,0.2242059,0.1685892,0.1198225,0.0785803,0.04486247,0.01866903,0,0.2528838,0.2628217,0.2763088,0.2933452,0.3139308,0.3380657,0.3658917,0.397551,0.4330435,0.4723691,0.515528,0.536362,0.5562733,0.5752618,0.5933274,0.6104703,0.6270098,0.6425555,0.6571074,0.6706655,0.6832298,0.6947294,0.7050932,0.7143212,0.7224135,0.72937,0.7351198,0.7395918,0.7427862,0.7447028,0.7453416,0.7442059,0.7407986,0.7351198,0.7271695,0.7169476,0.7053061,0.6923869,0.6781899,0.6627152,0.6459627,0.6285359,0.6103283,0.5913398,0.5715705,0.5510204,0.5302218,0.5097072,0.4894765,0.4695297,0.4498669,0.433008,0.4157941,0.3982254,0.3803017,0.3620231,0.3439929,0.3261047,0.3083585,0.2907542,0.2732919,0.2560781,0.2392192,0.2227152,0.2065661,0.190772,0.1755457,0.1611003,0.1474357,0.1345519,0.122449,0.1111979,0.1008696,0.09146406,0.08298137,0.07542147,0.06935226,0.06463177,0.06125998,0.05923691,0.05856256,0.06005324,0.06452529,0.0719787,0.08241349,0.09582964,0.1120852,0.1303283,0.150559,0.1727773,0.1969831,0.2229281,0.2503638,0.2792902,0.3097072,0.3416149,0.3745519,0.4080568,0.4421295,0.4767702,0.5119787,0.5880035,0.6570719,0.7191837,0.774339,0.8225377,0.8640994,0.8993434,0.9282697,0.9508784,0.9671695,0.7133984,0.7043478,0.6928128,0.6787933,0.6622893,0.6433008,0.6216504,0.5971606,0.5698314,0.5396628,0.5066548,0.4850399,0.4649157,0.4462822,0.4291393,0.4134871,0.3994676,0.3865129,0.3746229,0.3637977,0.3540373,0.345661,0.3382786,0.33189,0.3264951,0.3220941,0.3188997,0.3164153,0.3146406,0.3135759,0.3132209,0.3141083,0.3167702,0.3212067,0.3274179,0.3354037,0.3448092,0.3552795,0.3668146,0.3794144,0.393079,0.4080213,0.4237445,0.4402484,0.4575333,0.4755989,0.4944454,0.5133629,0.5323514,0.5514108,0.5705413,0.5894587,0.6085892,0.6279326,0.6474889,0.6672582,0.687063,0.7067258,0.7262467,0.7456256,0.7648625,0.7838154,0.8023425,0.8204437,0.8381189,0.8553682,0.8719787,0.8877374,0.9026442,0.9166992,0.9299024,0.9421473,0.9533274,0.9634428,0.9724933,0.9804791,0.9875067,0.9929725,0.9968767,0.9992192,1),
                     y=c(0.2956835,0.270705,0.2464173,0.2228201,0.1999137,0.1776978,0.1566906,0.1368345,0.1181295,0.1005755,0.08417266,0.06903597,0.05528058,0.04290647,0.03191367,0.02230216,0.01427338,0.008028777,0.003568345,0.0008920863,0,0.002848921,0.01139568,0.02564029,0.04558273,0.07122302,0.1023022,0.1385612,0.18,0.2266187,0.2784173,0.305036,0.2791079,0.2554245,0.2339856,0.2147914,0.1978417,0.1838561,0.1729784,0.1652086,0.1605468,0.1589928,0.1592518,0.1600288,0.1613237,0.1631367,0.1654676,0.1683741,0.1719137,0.1760863,0.1808921,0.1863309,0.1924604,0.1993381,0.206964,0.2153381,0.2244604,0.2346475,0.2456403,0.2574388,0.2700432,0.2834532,0.2984173,0.3122302,0.3248921,0.3364029,0.3467626,0.3564604,0.3654101,0.3736115,0.3810647,0.3877698,0.3941295,0.3999712,0.405295,0.4101007,0.4143885,0.418705,0.4230216,0.4273381,0.4316547,0.4359712,0.4397698,0.4436835,0.4477122,0.4518561,0.4561151,0.4608921,0.4660144,0.471482,0.477295,0.4834532,0.4899856,0.4969209,0.504259,0.512,0.5201439,0.5290935,0.5386763,0.5488921,0.559741,0.571223,0.5833669,0.5962014,0.6097266,0.6239424,0.6388489,0.6548201,0.6716547,0.6893525,0.7079137,0.7273381,0.7547626,0.7806331,0.8049496,0.8277122,0.8489209,0.8688921,0.8873669,0.9043453,0.9198273,0.9338129,0.9466187,0.9579856,0.9679137,0.9764029,0.9834532,0.9894101,0.9940432,0.9973525,0.9993381,1,0.9974388,0.9897554,0.9769496,0.9590216,0.9359712,0.9078273,0.8740432,0.8346187,0.789554,0.7388489,0.7179856,0.7428777,0.7651799,0.7848921,0.8020144,0.8165468,0.8284604,0.8377266,0.8443453,0.8483165,0.8496403,0.8492662,0.8481439,0.8462734,0.8436547,0.8402878,0.8365468,0.8322302,0.8273381,0.8218705,0.8158273,0.8095827,0.8029353,0.7958849,0.7884317,0.7805755,0.7727194,0.7646906,0.7564892,0.7481151,0.7395683,0.7262158,0.7137842,0.7022734,0.6916835,0.6820144,0.6733813,0.6653237,0.6578417,0.6509353,0.6446043,0.6387338,0.6332086,0.6280288,0.6231942,0.618705,0.6146763,0.6106475,0.6066187,0.6025899,0.5985612,0.594705,0.5906187,0.5863022,0.5817554,0.5769784,0.5721727,0.566964,0.5613525,0.5553381,0.5489209,0.5423309,0.535223,0.5275971,0.5194532,0.5107914,0.5018129,0.4921439,0.4817842,0.4707338,0.4589928,0.4465036,0.4332086,0.4191079,0.4042014,0.3884892,0.3718849,0.3543022,0.335741,0.3162014,0.2956835))
                ),
         T=list(list(color="black", 
                     x=c(0.633243,0.633243,0.366757,0.366757,0,0,1,1,0.633243),
                     y=c(0.8309859,0,0,0.8309859,0.8309859,1,1,0.8309859,0.8309859))
                ),
         U=list(list(color="black", 
                     x=c(0.4840371,0.4618023,0.44,0.4186303,0.3976931,0.3771885,0.3571164,0.3374768,0.3182698,0.2994954,0.2811535,0.2811535,0.2635015,0.2463852,0.2298043,0.213759,0.1982492,0.183275,0.1688363,0.1549331,0.1415654,0.1287333,0.1287333,0.1166529,0.1051287,0.09416066,0.08374871,0.07389289,0.0645932,0.05584964,0.0476622,0.0400309,0.03295572,0.03295572,0.02669413,0.02109166,0.0161483,0.01186406,0.008238929,0.005272915,0.002966014,0.001318229,0.0003295572,0,0,0,0.3038105,0.3038105,0.3039135,0.3042225,0.3047374,0.3054583,0.3063852,0.307518,0.3088568,0.3104016,0.3121524,0.3141092,0.3141092,0.3162822,0.3186818,0.3213079,0.3241607,0.32724,0.3305458,0.3340783,0.3378373,0.3418229,0.346035,0.346035,0.3507003,0.3556334,0.3608342,0.3663028,0.3720391,0.3780433,0.3843151,0.3908548,0.3976622,0.4047374,0.4047374,0.4121009,0.4197734,0.4277549,0.4360453,0.4446447,0.453553,0.4627703,0.4722966,0.4821318,0.492276,0.492276,0.5024408,0.5123378,0.521967,0.5313285,0.5404222,0.5492482,0.5578064,0.5660968,0.5741195,0.5818744,0.5818744,0.5893718,0.596622,0.6036251,0.6103811,0.6168898,0.6231514,0.6291658,0.6349331,0.6404531,0.6457261,0.6457261,0.6507415,0.6554892,0.6599691,0.6641813,0.6681256,0.6718023,0.6752111,0.6783522,0.6812255,0.6838311,0.6838311,0.6861792,0.6882801,0.6901339,0.6917405,0.6930999,0.6942122,0.6950772,0.6956952,0.6960659,0.6961895,0.6961895,0.6961895,1,1,0.9996395,0.9985582,0.9967559,0.9942327,0.9909887,0.9870237,0.9823378,0.976931,0.9708033,0.9639547,0.9639547,0.9564264,0.9482595,0.9394542,0.9300103,0.9199279,0.909207,0.8978476,0.8858496,0.8732132,0.8599382,0.8599382,0.8462616,0.8320082,0.8171782,0.8017714,0.7857878,0.7692276,0.7520906,0.7343769,0.7160865,0.6972194,0.6972194,0.678033,0.6583728,0.6382389,0.6176313,0.5965499,0.5749949,0.552966,0.5304634,0.5074871,0.4840371,0.4840371),
                     y=c(0,0.0001972243,0.000788897,0.001775018,0.003155588,0.004930606,0.007100073,0.009663988,0.01262235,0.01597516,0.01972243,0.01972243,0.02406866,0.02892622,0.03429511,0.04017531,0.04656684,0.05346969,0.06088386,0.06880935,0.07724617,0.0861943,0.0861943,0.09584368,0.106092,0.1169394,0.1283857,0.140431,0.1530752,0.1663185,0.1801607,0.1946019,0.2096421,0.2096421,0.2253543,0.2418115,0.2590139,0.2769613,0.2956538,0.3150913,0.3352739,0.3562016,0.3778744,0.4002922,0.4002922,1,1,0.4024836,0.3896786,0.3772681,0.365252,0.3536304,0.3424032,0.3315705,0.3211322,0.3110884,0.301439,0.2921841,0.2921841,0.2834405,0.2750329,0.2669613,0.2592257,0.2518262,0.2447626,0.2380351,0.2316435,0.225588,0.2198685,0.2198685,0.2146092,0.2096421,0.2049671,0.2005844,0.1964938,0.1926954,0.1891892,0.1859752,0.1830533,0.1804237,0.1804237,0.1782031,0.1762162,0.1744631,0.1729438,0.1716581,0.1706063,0.1697882,0.1692038,0.1688532,0.1687363,0.1687363,0.1688605,0.169233,0.1698539,0.1707232,0.1718408,0.1732067,0.174821,0.1766837,0.1787947,0.1811541,0.1811541,0.1839372,0.187027,0.1904237,0.1941271,0.1981373,0.2024543,0.2070782,0.2120088,0.2172462,0.2227904,0.2227904,0.2286633,0.2348868,0.2414609,0.2483857,0.2556611,0.2632871,0.2712637,0.2795909,0.2882688,0.2972973,0.2972973,0.3067056,0.316523,0.3267495,0.337385,0.3484295,0.3598831,0.3717458,0.3840175,0.3966983,0.4097882,0.4097882,1,1,0.4112491,0.3888093,0.3670709,0.3460336,0.3256976,0.3060628,0.2871293,0.268897,0.251366,0.2345362,0.2184076,0.2184076,0.2030679,0.1883126,0.1741417,0.1605551,0.147553,0.1351351,0.1233017,0.1120526,0.1013879,0.09130752,0.09130752,0.08192841,0.07307524,0.06474799,0.05694668,0.04967129,0.04292184,0.03669832,0.03100073,0.02582907,0.02118335,0.02118335,0.01715851,0.01355734,0.01037984,0.007626004,0.005295836,0.003389335,0.001906501,0.0008473338,0.0002118335,0,0))
                ),
         V=list(list(color="black", 
                     x=c(0.623366,0.379085,0,0.251634,0.4419935,0.4442729,0.4465359,0.4487827,0.4510131,0.4532271,0.4554248,0.4576062,0.4597712,0.4619199,0.4640523,0.4640523,0.4661601,0.4682353,0.4702778,0.4722876,0.4742647,0.4762092,0.4781209,0.48,0.4818464,0.4836601,0.4836601,0.4856127,0.487549,0.489469,0.4913725,0.4932598,0.4951307,0.4969853,0.4988235,0.5006454,0.502451,0.502451,0.5040931,0.5057516,0.5074265,0.5091176,0.5108252,0.512549,0.5142892,0.5160458,0.5178186,0.5196078,0.5196078,0.5212663,0.5229739,0.5247304,0.5265359,0.5283905,0.5302941,0.5322467,0.5342484,0.536299,0.5383987,0.5383987,0.5406863,0.5429739,0.5452614,0.547549,0.5498366,0.5521242,0.5544118,0.5566993,0.5589869,0.5612745,0.5612745,0.750817,1,0.623366),
                     y=c(0,0,1,1,0.4255004,0.4188139,0.4120979,0.4053521,0.3985767,0.3917717,0.384937,0.3780726,0.3711787,0.364255,0.3573017,0.3573017,0.3503929,0.3436027,0.3369311,0.3303781,0.3239437,0.3176279,0.3114307,0.3053521,0.2993921,0.2935508,0.2935508,0.2867606,0.2800297,0.273358,0.2667457,0.2601927,0.253699,0.2472646,0.2408895,0.2345738,0.2283173,0.2283173,0.2344255,0.240593,0.2468199,0.253106,0.2594514,0.2658562,0.2723202,0.2788436,0.2854262,0.2920682,0.2920682,0.2977687,0.3036027,0.3095701,0.3156709,0.3219051,0.3282728,0.3347739,0.3414085,0.3481764,0.3550778,0.3550778,0.3621868,0.3692809,0.3763603,0.3834248,0.3904744,0.3975093,0.4045293,0.4115345,0.4185248,0.4255004,0.4255004,1,1,0))
                ),
         W=list(list(color="black", 
                     x=c(0.8289902,0.6270358,0.5749186,0.5732248,0.5714007,0.5694463,0.5673616,0.5651466,0.5628339,0.560456,0.558013,0.5555049,0.5529316,0.5506189,0.548241,0.545798,0.5432899,0.5407166,0.5384365,0.5361564,0.5338762,0.5315961,0.529316,0.5237785,0.518241,0.5127036,0.5071661,0.5016287,0.495798,0.4900326,0.4843322,0.4786971,0.473127,0.4708143,0.4684365,0.4659935,0.4634853,0.4609121,0.4585993,0.4562215,0.4537785,0.4512704,0.4486971,0.4464169,0.4441368,0.4418567,0.4395765,0.4372964,0.4350814,0.4329967,0.4310423,0.4292182,0.4275244,0.3737785,0.1718241,0,0.2109121,0.2833876,0.2849511,0.2863844,0.2876873,0.2888599,0.2899023,0.2908469,0.2917264,0.2925407,0.2932899,0.2939739,0.2945928,0.2951466,0.2956352,0.2960586,0.2964169,0.2984691,0.3007166,0.3031596,0.305798,0.3086319,0.3113029,0.3141042,0.3170358,0.3200977,0.3232899,0.3266124,0.3300651,0.3336482,0.3373616,0.3412052,0.4218241,0.5806189,0.6612378,0.665342,0.6691857,0.6727687,0.6760912,0.6791531,0.6823453,0.6854072,0.6883388,0.6911401,0.6938111,0.696645,0.6992834,0.7017264,0.7039739,0.7060261,0.7063518,0.7066775,0.7070033,0.707329,0.7076547,0.708013,0.7084365,0.7089251,0.7094788,0.7100977,0.7107818,0.7115309,0.7123453,0.7132248,0.7141694,0.7152117,0.7163844,0.7176873,0.7191205,0.720684,0.7890879,1,0.8289902),
                     y=c(0,0,0.1979244,0.2037658,0.2100222,0.2166938,0.2237806,0.2312824,0.2390808,0.2470571,0.2552113,0.2635434,0.2720534,0.2809785,0.2899629,0.2990067,0.3081097,0.3172721,0.3267013,0.3360119,0.3452039,0.3542772,0.363232,0.384166,0.4054559,0.4271016,0.449103,0.4714603,0.4488362,0.4266271,0.4048332,0.3834544,0.3624907,0.353536,0.3444626,0.3352706,0.32596,0.3165308,0.3073684,0.2982654,0.2892216,0.2802372,0.2713121,0.2628021,0.25447,0.2463158,0.2383395,0.2305411,0.2233062,0.216427,0.2099036,0.2037361,0.1979244,0,0,1,1,0.4848036,0.4730319,0.4608451,0.4482431,0.4352261,0.4217939,0.4083024,0.3951075,0.382209,0.3696071,0.3573017,0.3431282,0.3290734,0.3151371,0.3013195,0.2876205,0.2984136,0.309444,0.3207116,0.3322165,0.3439585,0.3545738,0.3656635,0.3772276,0.3892661,0.4017791,0.4148851,0.4281097,0.4414529,0.4549148,0.4684952,0.7197924,0.7197924,0.4684952,0.4551816,0.4419274,0.4287324,0.4155967,0.4025204,0.3900074,0.3779689,0.3664047,0.355315,0.3446998,0.3329281,0.3213343,0.3099185,0.2986805,0.2876205,0.2884211,0.2908228,0.2948258,0.3004299,0.3076353,0.3160267,0.325189,0.3351223,0.3458265,0.3573017,0.3693403,0.3817346,0.3944848,0.4075908,0.4210526,0.4347517,0.4479763,0.4607265,0.4730022,0.4848036,1,1,0))
                ),
         X=list(list(color="black", 
                     x=c(0.7477624,0.5012205,0.2538649,0,0.3734744,0.03336046,0.2872254,0.5012205,0.714402,0.9666395,0.6183889,1,0.7477624),
                     y=c(0,0.3654559,0,0,0.5270571,1,1,0.6812454,1,1,0.5270571,0,0))
                ),
         Y=list(list(color="black", 
                     x=c(0.6202946,0.6202946,0.3797054,0.3797054,0,0.2528642,0.4983633,0.7471358,1,0.6202946),
                     y=c(0.4121572,0,0,0.4121572,1,1,0.5804299,1,1,0.4121572))
                ),
         Z=list(list(color="black", 
                     x=c(1,0,0,0.6384396,0.07231208,0.07231208,0.9609895,0.9609895,0.32255,1,1),
                     y=c(0,0,0.1549296,0.828762,0.828762,1,1,0.8480356,0.171238,0.171238,0))
                )
         )
  x <- letterPolygon[[toupper(ch)]]
  x <- lapply(x, function(.ele){
    if(.ele$color=="black") .ele$color <- color
    .ele
  })
  return(x)
}

coloredSymbols <- function(ncha, font, color, rname, alpha, 
                           fontface="bold", envir = .globals){
  symbols<-list()
  for(i in 1:ncha){
    symbols[[i]]<-importSVG(font, color[i], rname[i], fontface)
  }
  if(!missing(alpha)){
    for(i in 1:ncha){
      symbols[[paste0(i, "_", alpha)]]<-
        importSVG(font, colalpha(color, alpha)[i], rname[i], 
                  fontface, envir = envir)
    }
  }
  symbols
}

addPseudolog2<-function(x){
    x <- round(x, digits=6)
    ifelse(x < .000001, -20, log2(x)) ## !important -10.
}

## get Information Entropy from matrix
getIE<-function(x){
    addPseudolog2(nrow(x))
}

UngappedAlignment<-function(pfms, i, threshold, minimalConsensus=0, 
                            rcpostfix="(RC)", revcomp=TRUE){
    if(!is(pfms[[i]], "pfm")){
        pcms <- pfms
        pfms <- lapply(pfms, pcm2pfm)
    }else{
        pcms <- NULL
    }
    res<-getAlignedICWithoutGap(pfms[[i-1]], pfms[[i]], threshold, revcomp)
    if(!is.null(pcms)) pfms <- pcms
    if(res$max>=minimalConsensus){
        if(res$rev){
            pfms[[i]]<-matrixReverseComplement(pfms[[i]])
            pfms[[i]]@name<-paste(pfms[[i]]@name, rcpostfix, sep="")
        }
        if(res$offset>0){
            pfms[[i]]<-addBlank(pfms[[i]], res$offset, FALSE)
        }else{
            if(res[1]<0){
                pfms[1:(i-1)]<-lapply(pfms[1:(i-1)],function(.ele) 
                  addBlank(.ele, -1*res$offset, FALSE))
            }
        }
    }
    pfms
}
getAlignedICWithoutGap<-function(pfm1, pfm2, threshold, revcomp=TRUE){
    if(!is(pfm1, "pfm") | !is(pfm2, "pfm")) 
      stop("class of pfm1 and pfm2 must be pfm")
    offset1<-getoffsetPosByIC(pfm1, pfm2, threshold)
    if(revcomp){
        pfm3<-matrixReverseComplement(pfm2)
        offset2<-getoffsetPosByIC(pfm1, pfm3, threshold)
    }else{
        offset2<-list(k=0,max=0)
    }
    offset<-0
    rev<-FALSE
    if((offset1$max < offset2$max)){
        rev<-TRUE
        max<-offset2$max
        offset<-offset2$k
    }else{
        max<-offset1$max
        offset<-offset1$k
    }
    list(offset=offset,rev=rev,max=max)    
}
getICbyBase<-function(p, pfmj){
    re<-rep(0, 5)
    re[1:4]<-pfmj * (addPseudolog2(pfmj) - addPseudolog2(p))
    re[5]<-sum(re[1:4])
    re
}
getALLRbyBase <- function(b, pfmi, pfmj){##return 2x ALLR
    sum(pfmj * (addPseudolog2(pfmi) - addPseudolog2(b))) + 
        sum(pfmi * (addPseudolog2(pfmj) - addPseudolog2(b)))
}
checkALLR <- function(...){
    getALLRbyBase(...)>0
}
SWU <- function(pattern, subject, b, 
                match=1, mismatch=-1, 
                gap=-1000){## motif length will never longer than 1000
    if(!is(pattern, "matrix") || !is(subject, "matrix")){
        stop("pattern and subject must be numeric matrix")
    }
    m <- ncol(pattern)
    n <- ncol(subject)
    score <- matrix(0, nrow=m+1, ncol=n+1)
    point <- matrix("none", nrow=m+1, ncol=n+1)
    max_i <- 1
    max_j <- 1
    max_score <- 0
    for(i in 1:m){
        for(j in 1:n){
            diagonal_score <- 0
            left_score <- 0
            up_score <- 0
            #calculate match score
            col1 <- subject[, j]
            col2 <- pattern[, i]
            #score by KLLR
            if(checkALLR(b, col1, col2)){
                diagonal_score <- score[i, j] + match
            }else{
                diagonal_score <- score[i, j] + mismatch
            }
            
            #calculate gap scores
            up_score <- score[i, j+1] + gap
            left_score <- score[i+1, j] + gap
            
            if(diagonal_score <=0 && up_score <=0 && left_score <=0){
                score[i+1, j+1] <- 0
                point[i+1, j+1] <- "none"
                next # terminate this iteration of the loop
            }
            
            #choose best score
            if(diagonal_score >= up_score){
                if(diagonal_score >= left_score){
                    score[i+1, j+1] <- diagonal_score
                    point[i+1, j+1] <- "diagonal"
                }else{
                    score[i+1, j+1] <- left_score
                    point[i+1, j+1] <- "left"
                }
            }else{
                if(up_score > left_score){
                    score[i+1, j+1] <- up_score
                    point[i+1, j+1] <- "up"
                }else{
                    score[i+1, j+1] <- left_score
                    point[i+1, j+1] <- "left"
                }
            }
            
            #set maximum score
            if(score[i+1, j+1] > max_score){
                max_i <- i+1
                max_j <- j+1
                max_score <- score[i+1, j+1]
            }
        }
    }
    #trace-back
    align1 <- c()
    align2 <- c()
    
    i <- max_i
    j <- max_j
    while(1){
        if(point[i, j]=="none"){
            break
        }
        
        if(point[i, j]=="diagonal"){
            align1 <- c(align1, j-1)
            align2 <- c(align2, i-1)
            i <- i-1
            j <- j-1
        }else{
            if(point[i, j]=="left"){
                align1 <- c(align1, j-1)
                align2 <- c(align2, 0)
                j <- j-1
            }else{
                if(point[i, j]=="up"){
                    align1 <- c(align1, 0)
                    align2 <- c(align2, i-1)
                    i <- i-1
                }
            }
        }
    }
    align1 <- rev(align1)
    align2 <- rev(align2)
    if(length(align1)<1 | length(align2)<1){
        k <- 0
    }else{
        k=align1[1]-align2[1]
    }
    list(k=k, max=max_score)
}
ungappedScore <- function(query, subject, b, threshold){
    if(!is(query, "matrix") || !is(subject, "matrix")){
        stop("query and subject must be numeric matrix")
    }
    m <- ncol(query)
    n <- ncol(subject)
    score <- matrix(0, nrow=m+1, ncol=n+1)
    for(i in 1:m){
        for(j in 1:n){
            ic1 <- getICbyBase(b, query[, i])[5]
            ic2 <- getICbyBase(b, subject[, j])[5]
            if(ic1>=threshold && ic2>=threshold){
                value <- getICbyBase(b, c(query[, i]+subject[, j])/2)[5]
            }else{
                value <- 0
            }
            score[i+1, j+1] <- score[i, j] + value
        }
    }
    score[1:m, 1:n] <- 0
    max_score <- max(score)
    if(max_score==0){
        return(list(k=0, max=0))
    }
    idx <- which(score==max_score, arr.ind=TRUE)
    
    if(nrow(idx)>1){
        idxn <- apply(idx, 1, min)
        idx <- idx[which(idxn==min(idxn))[1], , drop=FALSE]
    }
    max_r <- idx[, "row"]
    max_c <- idx[, "col"]
    k <- max_r - max_c
    list(k=as.numeric(k), max=max_score)
}
getoffsetPosByIC<-function(pfm1, pfm2, threshold){
    if(!is(pfm1, "pfm") | !is(pfm2, "pfm")) 
      stop("class of pfm1 and pfm2 must be pfm")
    res <- ungappedScore(pfm1$mat, pfm2$mat, b=pfm1$background, threshold)
    res
}

#' @importFrom stats sd cor
getoffsetPosByIC_old<-function(pfm1, pfm2, threshold){
    if(!is(pfm1, "pfm") | !is(pfm2, "pfm")) 
      stop("class of pfm1 and pfm2 must be pfm")
    score1<-rep(0, ncol(pfm1@mat))
    score2<-rep(0, ncol(pfm2@mat))
    value1<-rep(0, ncol(pfm1@mat))
    value2<-rep(0, ncol(pfm2@mat))
    for(i in 1:ncol(pfm1@mat)){
        J<-ifelse(ncol(pfm1@mat)+1-i>ncol(pfm2@mat),
                  ncol(pfm2@mat),ncol(pfm1@mat)+1-i)
        for(j in 1:J){
            ic1<-getICbyBase(pfm1@background, pfm1@mat[,i+j-1])
            ic2<-getICbyBase(pfm2@background, pfm2@mat[,j])
            #ic3<-getALLRbyBase(pfm1@background, pfm1@mat[,i+j-1], pfm2@mat[,j])
            ic3 <- getICbyBase(pfm1@background, 
                               (pfm1@mat[,i+j-1]+pfm2@mat[,j])/2)
            if(sd(pfm1@mat[,i+j-1])==0 || sd(pfm2@mat[,j])==0){
                corr <- 0
            }else{
                corr <- cor(pfm1@mat[,i+j-1], pfm2@mat[,j], method="spearman")
            }
            if(ic1[5]>threshold & ic2[5]>threshold){
                #a<-ic1[1:4]>mean(ic1[1:4])
                #b<-ic2[1:4]>mean(ic2[1:4])
                #if(ic3>0) score1[i]<-score1[i]+1
                #if(ic3>0.25) {
                #if(any(a&b)){
                if(corr>0){
                    score1[i]<-score1[i]+1
                    value1[i] <- value1[i]+ic3[5]
                }
            }
        }
    }
    for(i in 1:ncol(pfm2@mat)){
        J<-ifelse(ncol(pfm2@mat)+1-i>ncol(pfm1@mat),
                  ncol(pfm1@mat),ncol(pfm2@mat)+1-i)
        for(j in 1:J){
            ic2<-getICbyBase(pfm2@background, pfm2@mat[,i+j-1])
            ic1<-getICbyBase(pfm1@background, pfm1@mat[,j])
            #ic3<-getALLRbyBase(pfm1@background, pfm1@mat[,j], pfm2@mat[,i+j-1])
            ic3 <- getICbyBase(pfm1@background, 
                               (pfm2@mat[,i+j-1]+pfm1@mat[,j])/2)
            if(sd(pfm1@mat[,j])==0 || sd(pfm2@mat[,i+j-1])==0){
                corr <- 0
            }else{
                corr <- cor(pfm1@mat[,j], pfm2@mat[,i+j-1], method="spearman")
            }
            if(ic1[5]>threshold & ic2[5]>threshold){
                #a<-ic1[1:4]>mean(ic1[1:4])
                #b<-ic2[1:4]>mean(ic2[1:4])
                #if(ic3>0) score2[i]<-score2[i]+1
                #if(ic3>0.25) {
                #if(any(a&b)){
                if(corr>0){
                    score2[i]<-score2[i]+1
                    value2[i] <- value2[i]+ic3[5]
                }
            }
        }
    }
    k1<-match(max(score1),score1)
    k2<-match(max(score2),score2)
    sc <- (score1[k1] < score2[k2]) || ((score1[k1] == score2[k2]) && 
                                            (value1[k1] < value2[k2]))
    k <- ifelse(sc, -1*(k2-1), (k1-1))
    max <- ifelse(sc, score2[k2], score1[k1])
    val <- ifelse(sc, value2[k2], value1[k1])
    list(k=k,max=max,val=val)
}

setClass("Rect", 
         representation(x="numeric", y="numeric",
                        width="numeric", height="numeric"), 
         prototype=prototype(x=0, y=0, width=0, height=0)
)

setGeneric("isContainedIn", function(a, b) standardGeneric("isContainedIn"))

setMethod("isContainedIn", signature(a="Rect", b="Rect"), function(a, b){
    a@x >= b@x && a@y >= b@y && 
      a@x+a@width <= b@x+b@width && a@y+a@height <= b@y+b@height
})

setClass("pos",
         representation(box="Rect", beta="numeric", sig="pfm", 
                        freq="numeric", norm="numeric")
)

getPFMid <- function(pfms, nodename, rcpostfix="(RC)"){
    pfmNames <- as.character(unlist(lapply(pfms, function(.ele) .ele@name)))
    pfmNames <- gsub(rcpostfix,"",pfmNames, fixed=TRUE)
    which(pfmNames==nodename)
}

getParentNode <- function(nodelist, nodename){
    for(i in 1:length(nodelist)){
        currNode <- nodelist[[i]]
        if(currNode@left==nodename) return(c(currNode@parent, "left"))
        if(currNode@right==nodename) return(c(currNode@parent, "right"))
    }
    NULL
}

makeLeaveNames <- function(ch){
    gsub(".", "_", make.names(ch), fixed=TRUE)
}

#' @importFrom graphics par
#' @importFrom grid stringWidth stringHeight grid.rect gpar grid.text
grid.eti <- function(x, y, label, clabel, boxes=FALSE, 
                     coul = rep(1, length(x)), 
                     bg = "white"){
  if (length(label) == 0) 
    return(invisible())
  if (is.null(label)) 
    return(invisible())
  if (any(label == "")) 
    return(invisible())
  cex0 <- par("cex") * clabel
  for (i in 1:(length(x))) {
    cha <- as.character(label[i])
    cha <- paste(" ", cha, " ", sep = "")
    x1 <- x[i]
    y1 <- y[i]
    xh <- cex0*stringWidth(cha)
    yh <- cex0*stringHeight(cha) * 1.66666666667
    if (boxes) {
      grid.rect(x=x1, y=y1, width=xh, height=yh, 
           gp=gpar(fill = bg, col = coul[i]), 
           default.units = "native")
    }
    grid.text(x=x1, y=y1, label=cha, 
              gp=gpar(cex = cex0, col = coul[i]), 
              default.units = "native")
  }
} 
